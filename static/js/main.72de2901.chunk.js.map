{"version":3,"sources":["components/messages.js","models/Ajax.js","components/Constants.js","components/Utils.js","components/Navigation.js","components/NavigationUser.js","components/Header.js","models/vault.js","components/Footer.js","components/AlertBox.js","components/Index.js","components/DialogBox.js","components/ModelRow.js","models/keypairs.js","models/models.js","components/ModelAssertion.js","components/ModelList.js","components/ModelEdit.js","components/KeypairAdd.js","components/KeypairEdit.js","components/KeypairGenerate.js","components/KeypairStore.js","components/AccountList.js","models/accounts.js","components/AccountForm.js","components/AccountEdit.js","components/AccountKeyForm.js","components/KeypairList.js","components/KeypairStatus.js","components/Keypair.js","components/SigningLogRow.js","models/signinglog.js","components/SigningLogFilter.js","components/Pagination.js","components/SigningLog.js","components/SubstoreForm.js","components/SubstoreList.js","models/assertions.js","components/SystemUserForm.js","components/NavigationSubmenu.js","components/UserRow.js","models/users.js","components/UserList.js","components/UserEdit.js","App.js","index.js"],"names":["intlData","zh","en","Ajax","getToken","this","get","getAuthToken","url","qs","request","headers","post","data","then","response","json","put","delete","Role","sections","sectionFromPath","path","find","section","startsWith","sectionIdFromPath","parts","split","slice","T","message","lang","window","AppState","getLocale","Messages","parseResponse","includes","JSON","parse","body","error_code","statusCode","formatError","error_subcode","isLoggedIn","token","isUserStandard","isUser","isUserAdmin","isUserSuperuser","roleAsString","role","str","saveAccount","account","sessionStorage","setItem","ID","AuthorityID","Assertion","ResellerAPI","getAccount","parseInt","getItem","linksSuperuser","linksAdmin","linksStandard","Navigation","props","handleAccountChange","e","preventDefault","accountId","target","getAttribute","accounts","filter","a","handleAccountMenu","onAccountChange","setState","accountMenu","state","length","name","selectedAccount","className","href","onClick","aria-controls","aria-expanded","aria-haspopup","id","aria-hidden","aria-label","map","key","data-key","links","renderAccounts","l","active","link","Component","NavigationUser","renderUser","renderUserLogout","LANGUAGES","Header","handleLanguageChange","language","value","setLocale","rerender","handleToggleMenu","document","querySelector","classList","toggle","src","alt","width","height","title","Vault","version","Footer","getVersion","self","AlertBox","Index","error","renderError","DialogBox","classYes","classNo","small","handleCancelClick","handleYesClick","ModelRow","copyToClipboard","el","createElement","appendChild","select","execCommand","removeChild","model","confirmDelete","concat","deleteModel","cancelDelete","fingerprintModel","fingerprint","fingerprintUser","renderActions","showAssert","Keypair","list","keypairId","update","keypair","enable","disable","create","authorityId","keyName","generate","status","assertion","keyId","register","Models","modelId","modelAssertion","ModelAssertion","handleChangePrivateKeyModel","handleChangeSeries","handleChangeArchitecture","handleChangeRevision","handleChangeBase","handleChangeClassic","handleBlurClassic","toLowerCase","handleChangeDisplayName","handleChangeGadget","handleChangeKernel","handleChangeStore","handleChangeSnaps","handleSave","location","console","log","model_id","keypairs","getKeypairs","Keypairs","success","k","ma","colSpan","htmlFor","keypair_id","onChange","kpr","Active","KeyID","type","placeholder","min","onBlur","defaultValue","cancel","ModelList","handleRefresh","refresh","handleShowAssert","assertId","handleDelete","handleDeleteModel","models","mdl","handleDeleteModelCancel","renderTable","ModelEdit","handleChangeBrand","handleChangeModel","handleChangeAPIKey","handleChangePrivateKey","handleChangePrivateKeyUser","handleSaveClick","hideForm","setTitle","getModel","disabled","KeyName","KeypairAdd","handleChangeAuthorityId","handleChangeKeyName","handleChangeKey","handleFileUpload","reader","FileReader","file","files","onload","upload","result","readAsDataURL","getAccounts","KeypairEdit","getKeypair","KeypairGenerate","KeypairStore","keys","keyFromKeypair","handleChangeName","handleChangeEmail","email","handleChangePassword","password","handleChangeOTP","otp","AccountList","getModels","acc","m","messages","push","index","array","renderKeyStatus","ref","renderAccountKeys","Account","stores","storeNew","accountID","store","storeUpdate","storeDelete","AccountForm","Accounts","AccountEdit","handleChangeAccount","handleChangeReseller","checked","AccountKeyForm","handleChangeKeypair","KeypairList","handleToggle","keypr","aria-checked","aria-labelledby","renderRow","KeypairStatus","poll","setTimeout","bind","done","onRefresh","SigningLogRow","make","serialnumber","revision","moment","created","format","SigningLog","fromID","listForAccount","authorityID","offset","filters","download","all","lines","logs","forEach","d","line","join","csvContent","encodedUri","encodeURI","downloadLink","click","SigningLogFilter","expanded","expansionClick","items","item","i","handleItemClick","selected","Pagination","pageUp","pages","calculatePages","page","signalPageChange","pageDown","query","maxRecords","startRow","pageChange","filterString","totalLogs","searchText","onSearchChange","renderPaging","onDownload","handleExpansionClick","filterModels","getSigningLogs","SigningLogModel","total_count","getSigningLogFilters","handleSearchChange","handleDownload","endRow","n","renderRows","SubstoreForm","handleChangeSerial","handleChangeSubstore","handleChangeFromModel","handleChangeModelName","b","substore","fromModelID","modelname","onCancel","onSave","SubstoreList","handleShowNew","showNew","showEdit","showDelete","handleShowEdit","substores","s","handleShowDelete","handleSubstoreChange","field","handleSaveSubstore","handleDeleteSubstore","handleCancelSubstore","fromModel","renderSubstore","assert","SystemUserForm","onShowForm","handleChangeUsername","username","handleChangeSinceDate","date","hours","since","minutes","seconds","handleChangeSinceTime","time","t","handleChangeUntilDate","until","handleChangeUntilTime","onSubmit","form","validate","submitAssertion","utc","add","encodeURIComponent","test","downloadAssertion","required","NavigationSubmenu","tabIndex","aria-selected","UserRow","user","deleteUser","Username","Name","Email","APIKey","Users","userId","getotheraccounts","UserList","handleDeleteUser","users","handleDeleteUserCancel","getUsers","UserEdit","buildSelectBoxOption","val","handleChangeRole","requestData","buildRequestData","handleClickAccount","assignedAccounts","indexOf","splice","availableAccounts","getUser","getAllAccounts","accountsToAuthorityIDs","accs","style","data-account","readOnly","renderAccountSelect","history","createHistory","submenuModels","App","updateDataForRoute","listen","handleNavigation","scrollTo","currentSection","pathname","getSubstores","sub","subSectionIdFromPath","renderKeypairs","renderModels","renderUsers","container","getElementById","localStorage","render","callback","locale","ReactDOM","resp","enableUserAuth","jwt","authorization","jwtDecode","unmount","unmountComponentAtNode"],"mappings":"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","file":"static/js/main.72de2901.chunk.js","sourcesContent":["/*\n * Copyright (C) 2016-2018 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\n\nvar intlData = {\n    zh: {},\n\n    en: {\n      \"account\": \"Account\",\n      \"account-description\": \"The authority-id for the account\",\n      \"account-keys\": \"Account Key Assertions\",\n      \"accounts\": \"Accounts\",\n      \"activate\": \"Activate\",\n      \"active\": \"Active\",\n      \"add\": \"Add\",\n      \"add-new-model\": \"Add a new model\",\n      \"add-new-signing-key\": \"Import a signing key\",\n      \"add-new-user\": \"Add a new user\",\n      \"api-key\": \"API Key\",\n      \"api-key-description\": \"API Key to sign a serial assertion request (min. 10 characters). Will be generated if blank or invalid\",\n      \"architecture\": \"Architecture\",\n      \"architecture-description\": \"The architecture of the device\",\n      \"assertion\": \"Assertion\",\n      \"assertion-settings\": \"Configure the model assertion headers\",\n      \"assertion-status\": \"Assertion Status\",\n      \"authority-id-description\": \"The authority for signing models\",\n      \"authority-id\": \"Signing Authority\",\n      \"base\": \"Base\",\n      \"base-description\": \"The name of the base snap\",\n      \"brand\": \"Brand\",\n      \"brand-description\": \"The name of the device brand\",\n      \"cancel\": \"Cancel\",\n      \"classic\": \"Classic\",\n      \"classic-description\": \"(optional) Ubuntu Classic system: true or false\",\n      \"close\": \"Close\",\n      \"complete\": \"Complete\",\n      \"confirm-log-delete\": \"Remove this log?\",\n      \"confirm-model-delete\": \"Remove this model?\",\n      \"confirm-store-delete\": \"Remove this sub-store model?\",\n      \"confirm-user-delete\": \"Remove this user?\",\n      \"copy-api-key\": \"Copy API key to clipboard\",\n      \"create-assertion\": \"Error creating the assertion\",\n      \"create-system-user\": \"Create System-User\",\n      \"date\": \"Date\",\n      \"deactivate\": \"Deactivate\",\n      \"delete-log\": \"Delete log\",\n      \"delete-model\": \"Delete model\",\n      \"delete-user\": \"Delete user\",\n      \"description\": \"The Serial Vault is a web service that generates cryptographically-signed serial assertions.\",\n      \"display_name\": \"Display Name\",\n      \"display_name-description\": \"Descriptive name of the device\",\n      \"download\": \"Download\",\n      \"edit-model\": \"Edit Model\",\n      \"edit-user\": \"Edit User\",\n      \"email\": \"Email\",\n      \"email-description\": \"Email for the Store\",\n      \"error-adding-key\": \"Error adding a public key\",\n      \"error-auth\": \"Unauthorized action\",\n      \"error-created-model\": \"Cannot find the created model\",\n      \"error-creating-model\": \"Error creating the model\",\n      \"error-creating-store\": \"Error creating the sub-store model\",\n      \"error-creating-user\": \"Error creating the user\",\n      \"error-decode-json\": \"Error decoding JSON\",\n      \"error-decode-key\": \"Error decoding the base64 Signing Key\",\n      \"error-deleting-key\": \"Error deleting a public key\",\n      \"error-fetch-models\": \"Error fetching the models\",\n      \"error-fetch-users\": \"Error fetching the users\",\n      \"error-format-assertions\": \"Error formatting the assertions\",\n      \"error-get-model\": \"Cannot find the model\",\n      \"error-get-non-user-accounts\": \"Cannot get user not related accounts\",\n      \"error-get-user\": \"Cannot find the user\",\n      \"error-invalid-model\": \"Invalid model ID\",\n      \"error-invalid-user\": \"Invalid user ID\",\n      \"error-key-data\": \"No data supplied for the public key\",\n      \"error-key-exists\": 'The ssh public key already exists',\n      \"error-key-not-found\": \"The ssh public key cannot be found\",\n      \"error-model-data\": \"No model data supplied\",\n      \"error-model-exists\": \"A device with the same Brand and Model already exists\",\n      \"error-model-json\": \"Error with fields\",\n      \"error-model-not-active\": \"The model is linked with an inactive signing-key\",\n      \"error-model-not-found\": \"Cannot find model with the matching brand and model\",\n      \"error-nil-data\": \"Uninitialized POST data\",\n      \"error-no-permissions\": \"You do not have permissions to access this page\",\n      \"error-read-private-key\": \"Error reading the private key\",\n      \"error-sign-empty\": \"No data supplied for signing\",\n      \"error-signing-assertions\": \"Error signing the assertions\",\n      \"error-updating-model\": \"Error updating the model\",\n      \"error-updating-store\": \"Error updating sub-store model\",\n      \"error-updating-user\": \"Error updating the user\",\n      \"error-user-data\": \"No user data supplied\",\n      \"error-validate-key\": \"The public key must be entered\",\n      \"error-validate-model\": \"The Brand and Model must be supplied\",\n      \"error-validate-new-model\": \"The Brand, Model and Signing-Keys must be supplied\",\n      \"error-validate-signingkey\": \"The Serial Assertion Key must be selected\",\n      \"error-validate-userkey\": \"The System-User Assertion Key must be selected\",\n      \"find-serialnumber\": \"find serial number\",\n      \"fingerprint\": \"Fingerprint\",\n      \"gadget\": \"Gadget Snap\",\n      \"gadget-description\": \"The name of the gadget snap\",\n      \"generate\": \"Generate\",\n      \"generate-signing-key\": \"Generate Signing Key\",\n      \"home\": \"Home\",\n      \"inactive\": \"Inactive\",\n      \"invalid-keypair\": \"The signing-key is invalid\",\n      \"kernel\": \"Kernel Snap\",\n      \"kernel-description\": \"The name of the kernel snap\",\n      \"key-id\": \"Key ID\",\n      \"key-name-description\": \"Unique name for the key in the store\",\n      \"key-name\": \"Key Name\",\n      \"key-name-missing\": \"The key name must be entered\",\n      \"login\": \"Login\",\n      \"logout\": \"Logout\",\n      \"makes\": \"Brands\",\n      \"model-description\": \"The name of the device model\",\n      \"model\": \"Model\",\n      \"modelname\": \"Model Name\",\n      \"modelname-description\": \"The name of the pivoted model\",\n      \"models_available\": \"The following models are available\",\n      \"models\": \"Models\",\n      \"more\": \"More\",\n      \"name\": \"Full name\",\n      \"new-account-assertion\": \"Add or Replace Account Assertion\",\n      \"new-account-key-assertion\": \"Add or Replace Account Key Assertion\",\n      \"new-model\": \"New Model\",\n      \"new-public-key-description\": \"Paste the public key of the machine that needs access to the Serial Vault\",\n      \"new-public-key\": \"New Public Key\",\n      \"new-signing-key-description\": \"Paste the signing-key or upload the file\",\n      \"new-signing-key\": \"Import Signing Key\",\n      \"new-substore-device\": \"Create a new sub-store mapping for a device\",\n      \"new-user\": \"New User\",\n      \"no\": \"No\",\n      \"no-assertion-key\": \"No account key assertion found\",\n      \"no-assertion\": \"No account assertion found\",\n      \"no-assertions\": \"No assertions found\",\n      \"no-signing-keys-found\": \"No signing keys found\",\n      \"not-used-signing\": \"Not used for signing system-user assertions\",\n      \"otp\": \"OTP\",\n      \"otp-description\": \"One-time password for SSO\",\n      \"password\": \"Password\",\n      \"password-description\": \"Password for the Store\",\n      \"private-key-description\": \"The signing-key that will be used to sign the device identity\",\n      \"private-key-model\": \"Model Assertion Key\",\n      \"private-key-model-short\": \"Assertion\",\n      \"private-key\": \"Serial Assertion Key\",\n      \"private-key-short\": \"Serial Key\",\n      \"private-key-user-description\": \"The signing-key that will be used to sign the system-user assertion\",\n      \"private-key-user-short\": \"System-User Key\",\n      \"private-key-user\": \"System-User Assertion Key\",\n      \"public-key-confirm\": \"Confirm deletion of the public key\",\n      \"public-key-description\": \"Add a new public key\",\n      \"public-key\": \"Public Key\",\n      \"public-keys-authorized\": \"The following keys are authorized\",\n      \"public-keys\": \"Public Keys\",\n      \"register-signing-key\": \"Register Signing Key with the Store\",\n      \"remove\": \"Remove\",\n      \"required-snaps\": \"Required Snaps\",\n      \"required-snaps-description\": \"(optional) List of required snaps - enter a comma-separated list\",\n      \"reseller\": \"Reseller\",\n      \"reseller-features\": \"Enable Reseller Features\",\n      \"revision\": \"Revision\",\n      \"revision-description\": \"Revision of the assertion\",\n      \"role\": \"Role\",\n      \"save\": \"Save\",\n      \"select-accounts\": \"Select below the accounts this user belongs to:\",\n      \"serial-number-description\": \"Serial Number of the device\",\n      \"serial-number\": \"Serial Number\",\n      \"series\": \"Series\",\n      \"series-description\": \"Snap namespace series\",\n      \"signing-key\": \"Signing Key\",\n      \"signing-keys\": \"Signing Keys\",\n      \"signinglog-description\": \"Log of the serial numbers and device-key fingerprints that have been used\",\n      \"signinglog\": \"Signing Log\",\n      \"store\": \"Store\",\n      \"store-description\": \"ID of the brand store\",\n      \"store-account-assertion\": \"Account Assertion from Store\",\n      \"store-credentials\": \"Store Credentials\",\n      \"store-keypair\": \"Error storing the signing key\",\n      \"substore\": \"Sub-Store\",\n      \"substore-description\": \"Store ID of the Sub-Store\",\n      \"substore-model\": \"Sub-Store Model\",\n      \"substores\": \"Sub-Store Models\",\n      \"systemuser\": \"System-User\",\n      \"title\": \"Serial Vault\",\n      \"upload-account-assertion\": \"Upload Account Assertion\",\n      \"user-accounts\": \"User Accounts\",\n      \"user-email\": \"The email address of the user\",\n      \"user-key\": \"User Key\",\n      \"user-name\": \"The full name of the user\",\n      \"username\": \"Username\",\n      \"user-not-found\": \"You do not have permissions to access this site\",\n      \"users_available\": \"The following users are available\",\n      \"users\": \"Users\",\n      \"user\": \"User\",\n      \"user-username\": \"The nickname of the user\",\n      \"version\": \"Version\",\n      \"yes\": \"Yes\",\n    }\n};\n\nexport default intlData;\n","/*\n * Copyright (C) 2016-2017 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport request from 'then-request';\n\nvar API_VERSION = '/v1/';\n\nvar Ajax = {\n\n\tgetToken: function() {\n\t\treturn this.get('token')\n\t},\n\n\tgetAuthToken: function() {\n\t\treturn this.get('authtoken')\n\t},\n\n\tget: function(url, qs) {\n\t\t\tif (!qs) {\n\t\t\t\tqs = {};\n\t\t\t}\n\t\t\treturn request('GET', API_VERSION + url, {\n\t\t\t\theaders: {},\n\t\t\t\tqs: qs\n\t\t\t});\n\t},\n\n\tpost: function(url, data) {\n\t\t// Get updated CSRF token before POST\n\t\treturn this.getToken().then(function(response) {\n\t\t\treturn request('POST', API_VERSION + url, {\n\t\t\t\theaders: {\n\t\t\t\t\t'X-CSRF-Token': response.headers['x-csrf-token'],\n\t\t\t\t},\n\t\t\t\tjson: data\n\t\t\t});\n\t\t});\n\t},\n\n\tput: function(url, data) {\n\t\t// Get updated CSRF token before PUT\n\t\treturn this.getToken().then(function(response) {\n\t\t\treturn request('PUT', API_VERSION + url, {\n\t\t\t\theaders: {\n\t\t\t\t\t'X-CSRF-Token': response.headers['x-csrf-token'],\n\t\t\t\t},\n\t\t\t\tjson: data\n\t\t\t});\n\t\t});\n\t},\n\n\tdelete: function(url, data) {\n\t\t// Get updated CSRF token before DELETE\n\t\treturn this.getToken().then(function(response) {\n\t\t\treturn request('DELETE', API_VERSION + url, {\n\t\t\t\theaders: {\n\t\t\t\t\t'X-CSRF-Token': response.headers['x-csrf-token'],\n\t\t\t\t},\n\t\t\t\tjson: data\n\t\t\t});\n\t\t});\n\t}\n}\n\nexport default Ajax;\n","/*\n * Copyright (C) 2017-2018 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nexport const Role = {\n    Standard: 100,\n    SyncUser: 150,\n    Admin: 200,\n    Superuser: 300,\n}","/*\n * Copyright (C) 2016-2017 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Messages from './messages'\nimport jwtDecode from 'jwt-decode'\nimport Ajax from '../models/Ajax'\nimport {Role} from './Constants'\n\n\nconst sections = ['signing-keys', 'models', 'keypairs', 'accounts', 'signinglog', 'substores', 'systemuser', 'users', 'notfound']\n\n\nexport function sectionFromPath(path) {\n  return path === '/' ? 'home' : (\n    sections.find(section => (\n      path.startsWith(`/${section}`)\n    )) || ''\n  )\n}\n\nexport function sectionIdFromPath(path, section) {\n  const parts = path.split('/').slice(1)\n  return (parts[0] === section && parts[1]) || ''\n}\n\nexport function subSectionIdFromPath(path, section) {\n    const parts = path.split('/').slice(1)\n    return (parts[0] === section && parts[2]) || ''\n}\n\nexport function T(message) {\n    const lang = window.AppState.getLocale()\n    const msg = Messages[lang][message] || message;\n    return msg\n}\n\nexport function parseResponse(response) {\n    // Check the content-type is JSON\n    if (!response.headers['content-type'].includes('json')) {\n        // Non-json body\n        return {\n            error_code: response.statusCode,\n            message: response.body\n        }\n    }\n\n    // Parse the body as JSON\n    return JSON.parse(response.body);\n}\n\nexport function formatError (data) {\n    var message = T(data.error_code);\n    if (data.error_subcode) {\n        message += ': ' + T(data.error_subcode);\n    } else if (data.message) {\n        message += ': ' + data.message;\n    }\n    return message;\n}\n\nexport function getAuthToken(callback) {\n\n    // Get a fresh token and return it to the callback\n    // The token will be passed to the views\n    Ajax.getAuthToken().then((resp) => {\n\n        // If user authentication is off, set up a default token\n        var data = JSON.parse(resp.body)\n        if (!data.enableUserAuth) {\n            callback({role: Role.Admin})\n            return\n        }\n\n        var jwt = resp.headers.authorization\n\n        if (!jwt) {\n            callback({})\n            return\n        }\n        var token = jwtDecode(jwt)\n\n        if (!token) {\n            callback({})\n            return\n        }\n        callback(token)\n    })\n\n}\n\nexport function authToken() {\n    if (localStorage.getItem('token')) {\n        var t = JSON.parse(localStorage.getItem('token'))\n        return t\n    } else {\n        return {}\n    }\n}\n\nexport function isLoggedIn(token) {\n    return isUserStandard(token)\n}\n\nexport function isUserStandard(token) {\n    return isUser(Role.Standard, token)\n}\n\nexport function isUserAdmin(token) {\n    return isUser(Role.Admin, token)\n}\n\nexport function isUserSuperuser(token) {\n    return isUser(Role.Superuser, token)\n}\n\nexport function roleAsString(role) {\n    var str\n    switch (role) {\n        case Role.Standard:\n            str = \"Standard\"\t\n            break;\n        case Role.SyncUser:\n            str = \"Sync API\"\n            break;\n        case Role.Admin:\n            str = \"Admin\"\n            break;\n        case Role.Superuser:\n            str = \"Superuser\"\n            break\n        default:\n            str= \"invalid role\"\n            break;\n    }\n    return str\n}\n\nfunction isUser(role, token) {\n    if (!token) return false\n    if (!token.role) return false\n\n    return (token.role >= role)\n}\n\nexport function saveAccount(account) {\n    sessionStorage.setItem('accountId', account.ID);\n    sessionStorage.setItem('accountCode', account.AuthorityID);\n    sessionStorage.setItem('accountAssertion', account.Assertion);\n    sessionStorage.setItem('accountReseller', account.ResellerAPI);\n}\n\nexport function getAccount() {\n    return {\n        ID: parseInt(sessionStorage.getItem('accountId'),10),\n        AuthorityID: sessionStorage.getItem('accountCode'),\n        Assertion: sessionStorage.getItem('accountAssertion'),\n        ResellerAPI: sessionStorage.getItem('accountReseller')==='true',\n    }\n}\n","/*\n * Copyright (C) 2016-2017 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport React, {Component} from 'react';\nimport {T, isLoggedIn} from './Utils'\nimport {Role} from './Constants'\n\nconst linksSuperuser = ['accounts', 'signing-keys', 'models', 'signinglog', \"users\"];\nconst linksAdmin = ['accounts', 'signing-keys', 'models', 'signinglog'];\nconst linksStandard = ['systemuser'];\n\n\nclass Navigation extends Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            accountMenu: false\n        }\n    }\n\n    handleAccountChange = (e) => {\n        e.preventDefault()\n\n        // Get the account\n        var accountId = parseInt(e.target.getAttribute('data-key'), 10)\n        var account = this.props.accounts.filter(a => {\n            return a.ID === accountId\n        })[0]\n\n        this.handleAccountMenu()\n        this.props.onAccountChange(account)\n    }\n\n    handleAccountMenu = (e) => {\n        if (e) {\n         e.preventDefault()\n        }\n        this.setState({accountMenu: !this.state.accountMenu})\n    }\n\n    renderAccounts(token) {\n        if (!isLoggedIn(token)) {\n            return <span />\n        }\n\n        if (this.props.accounts.length === 0) {\n            return <span />\n        }\n\n        var name = this.props.selectedAccount.AuthorityID\n        if (name.length > 20) {\n            name = name.slice(0, 20) + '...'\n        }\n\n        return (\n            <li className=\"p-navigation__link account-menu\">\n                <a href=\"/\" onClick={this.handleAccountMenu} className=\"p-contextual-menu__toggle\" aria-controls=\"#account-menu\" aria-expanded=\"false\" aria-haspopup=\"true\">\n                {name} <i className=\"fa fa-caret-down\"></i>\n                \n                {this.state.accountMenu ?\n                <span className=\"p-contextual-menu__dropdown\" id=\"account-menu\" aria-hidden=\"false\" aria-label=\"submenu\">\n                    <span className=\"p-contextual-menu__group\">\n                    {this.props.accounts.map(a => {\n                    return (\n                        <a key={a.ID} data-key={a.ID} href=\"/\" onClick={this.handleAccountChange} className=\"p-contextual-menu__link\">{a.AuthorityID}</a>\n                    )\n                    })}\n                    </span>\n                </span>\n                : ''\n                }\n                </a>\n            </li>\n        )\n\n    }\n\n    render() {\n\n        var token = this.props.token\n        var links;\n\n        switch(token.role) {\n            case Role.Admin:\n                links = linksAdmin;\n                break;\n            case Role.Superuser:\n                links = linksSuperuser;\n                break;\n            case Role.Standard:\n                links = linksStandard\n                break\n            default:\n                links = []\n        }\n\n        return (\n          <ul className=\"p-navigation__links\">\n              {this.renderAccounts(token)}\n              {links.map((l) => {\n                  var active = '';\n                  if (this.props.active === l) {\n                      active = ' active'\n                  }\n                  var link = '/' + l;\n                  return (\n                    <li key={l} className={'p-navigation__link' + active}><a href={link}>{T(l)}</a></li>\n                  )\n              })}\n          </ul>\n        );\n    }\n}\n\nexport default Navigation;\n","/*\n * Copyright (C) 2016-2017 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport React, {Component} from 'react';\nimport {T, isLoggedIn} from './Utils'\n\n\nclass NavigationUser extends Component {\n    renderUser(token) {\n        if (isLoggedIn(token)) {\n            // The name is undefined if user authentication is off\n            if (token.name) {\n                return (\n                    <li className=\"p-navigation__link\"><a href=\"https://login.ubuntu.com/\" className=\"p-link--external\">{token.name}</a></li>\n                )\n            }\n        } else {\n            return (\n            <li className=\"p-navigation__link\"><a href=\"/login\" className=\"p-link--external\">{T('login')}</a></li>\n            )\n        }\n    }\n\n    renderUserLogout(token) {\n        if (isLoggedIn(token)) {\n            // The name is undefined if user authentication is off\n            if (token.name) {\n                return (\n                    <li className=\"p-navigation__link\"><a href=\"/logout\">{T('logout')}</a></li>\n                )\n            }\n        }\n    }\n\n    render() {\n        var token = this.props.token\n\n        return (\n          <ul className=\"p-navigation__links u-float-right\">\n              {this.renderUser(token)}\n              {this.renderUserLogout(token)}\n          </ul>\n        );\n    }\n}\n\nexport default NavigationUser;\n","/*\n * Copyright (C) 2016-2017 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport React, {Component} from 'react';\nimport Navigation from './Navigation'\nimport NavigationUser from './NavigationUser'\nimport {T} from './Utils';\n\nconst LANGUAGES = {\n    en: 'English',\n    zh: 'Chinese'\n}\n\nclass Header extends Component {\n\n    constructor(props) {\n        super(props)\n        this.state = {\n            language: window.AppState.getLocale()\n        }\n    }\n\n    handleLanguageChange = (e) => {\n        e.preventDefault();\n        this.setState({language: e.target.value});\n        window.AppState.setLocale(e.target.value);\n        window.AppState.rerender();\n    }\n\n    renderLanguage(lang) {\n        if (this.state.language === lang) {\n            return (\n                <button onClick={this.handleLanguageChange} value={lang} className=\"p-button--neutral\">{LANGUAGES[lang]}</button>\n            );\n        } else {\n            return (\n                <button onClick={this.handleLanguageChange} value={lang}>{LANGUAGES[lang]}</button>\n            );\n        }\n    }\n\n    handleToggleMenu = (e) => {\n        e.preventDefault();\n\n        var navPrimary = document.querySelector('.p-navigation__nav');\n        navPrimary.classList.toggle('show');\n    }\n\n    render() {\n\n        return (\n        <div>\n            <header className=\"p-navigation p-navigation--light\" role=\"banner\">\n                <div className=\"p-navigation__logo\">\n                        <a href=\"/\" className=\"p-navigation__link\">\n                            <img src=\"/static/images/serial-vault-logo.svg\" alt={T(\"title\")} width=\"180px\" height=\"44px\" />\n                        </a>\n                </div>\n                <a href=\"#navigation\" className=\"p-navigation__toggle--open\" title=\"menu\" onClick={this.handleToggleMenu}>\n                    <img src=\"/static/images/navigation-menu-plain.svg\" width=\"30px\" alt=\"menu\" />\n                </a>\n                <nav className=\"p-navigation__nav\">\n                    <span className=\"u-off-screen\"><a href=\"#navigation\">Jump to site</a></span>\n                    <Navigation token={this.props.token}\n                        accounts={this.props.accounts} selectedAccount={this.props.selectedAccount} onAccountChange={this.props.onAccountChange} />\n                    <NavigationUser token={this.props.token} />\n                        {/*<form id=\"language-form\" className=\"header-search\">*/}\n                                {/* Add more languages here */}\n                                {/* this.renderLanguage('en') */}\n                                {/* this.renderLanguage('zh') */}\n                        {/*</form>*/}\n\n                </nav>\n            </header>\n\n        </div>\n        )\n    }\n}\n\nexport default Header;\n","/*\n * Copyright (C) 2016-2017 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Ajax from './Ajax';\n\nvar Vault = {\n\n\tversion: function () {\n\t\t\treturn Ajax.get('version');\n\t}\n}\n\nexport default Vault;\n","/*\n * Copyright (C) 2016-2017 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport React, {Component} from 'react';\nimport Vault from '../models/vault';\nimport {T} from './Utils';\n\n\nclass Footer extends Component {\n\n  constructor(props) {\n      super(props)\n      this.state = {version: null};\n  }\n\n  componentDidMount() {\n    this.getVersion();\n  }\n\n  getVersion() {\n    var self = this;\n    Vault.version().then(function(response) {\n      var data = JSON.parse(response.body);\n      self.setState({version: data.version});\n    });\n  }\n\n  render() {\n    return (\n      <footer className=\"spacer\">\n        <div className=\"row\">\n          <p><small>{T('version')}: {this.state.version}</small></p>\n        </div>\n      </footer>\n    );\n  }\n}\n\nexport default Footer;\n","/*\n * Copyright (C) 2016-2017 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport React, {Component} from 'react';\n\n\nclass AlertBox extends Component {\n    render() {\n        if (this.props.message) {\n            return (\n                <div className=\"p-notification--negative\">\n                    <p className=\"p-notification__response\">{this.props.message}</p>\n                </div>\n            );\n        } else {\n            return <span />;\n        }\n    }\n}\n\nexport default AlertBox;\n","/*\n * Copyright (C) 2016-2017 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport React, { Component } from 'react';\nimport {FormattedMessage} from 'react-intl'\nimport {T, isLoggedIn} from './Utils'\nimport AlertBox from './AlertBox'\n\n\nclass Index extends Component {\n\n  constructor(props) {\n\n    super(props)\n    this.state = {\n      token: props.token || {},\n    }\n  }\n\n  renderUser() {\n    if (isLoggedIn(this.props.token)) {\n      return <div />\n    } else {\n      return (\n        <div>\n          <a href=\"/login\" className=\"p-button--brand\">{T('login')}</a>\n        </div>\n      )\n    }\n  }\n\n  renderError() {\n    if (this.props.error) {\n      return (\n        <AlertBox message={T('user-not-found')} />\n      )\n    }\n  }\n\n  render() {\n    return (\n        <div className=\"row\">\n\n\n          <section className=\"row\">\n            <h2><FormattedMessage id=\"title\" /></h2>\n            {this.renderError()}\n            <div>\n              <div className=\"p-card\">\n                <FormattedMessage id=\"description\" />\n              </div>\n            </div>\n          </section>\n\n          <section className=\"row\">\n            {this.renderUser()}\n          </section>\n        </div>\n    );\n  }\n}\n\nexport default Index;","/*\n * Copyright (C) 2016-2017 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport React, {Component} from 'react';\nimport {T} from './Utils';\n\nclass DialogBox extends Component {\n\n    render() {\n        var classYes = 'p-button--brand'\n        var classNo = 'p-button--neutral'\n        if (this.props.small) {\n            classYes = 'p-button--brand small'\n            classNo = 'p-button--neutral small'\n        }\n\n        if (this.props.message) {\n            return (\n                <div className=\"p-card warning\">\n                    <p>{this.props.message}</p>\n                    <div>\n                        <a href=\"\" onClick={this.props.handleCancelClick} className={classNo}>\n                            {T('no')}\n                        </a>\n                        <a href=\"\" onClick={this.props.handleYesClick} className={classYes}>\n                            {T('yes')}\n                        </a>\n                    </div>\n                </div>\n            );\n        } else {\n            return <span />;\n        }\n    }\n}\n\nexport default DialogBox;\n","/*\n * Copyright (C) 2016-2017 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport React, {Component} from 'react';\nimport DialogBox from './DialogBox';\nimport {T} from './Utils'\n\nclass ModelRow extends Component {\n\n    copyToClipboard = (e) => {\n        e.preventDefault()\n        const el = document.createElement('textarea');\n        el.value = e.target.getAttribute('data-key');\n        document.body.appendChild(el);\n        el.select();\n        document.execCommand('copy');\n        document.body.removeChild(el);\n    }\n\n    renderActions() {\n        if (this.props.model.id !== this.props.confirmDelete) {\n            return (\n                <div>\n                    <a href={'/models/'.concat(this.props.model.id, '/edit')} className=\"p-button--brand small\" title={T('edit-model')}><i className=\"fa fa-pencil\"></i></a>\n                    &nbsp;\n                    <a href=\"\" onClick={this.props.delete} data-key={this.props.model.id} className=\"p-button--neutral small\" title={T('delete-model')}>\n                        <i className=\"fa fa-trash\" data-key={this.props.model.id}></i></a>\n                </div>\n            );\n        } else {\n            return (\n                <DialogBox message={T('confirm-model-delete')} handleYesClick={this.props.deleteModel} handleCancelClick={this.props.cancelDelete} small />\n            );\n        }\n    }\n\n    render() {\n        var fingerprint = this.props.model['key-id'];\n        var fingerprintUser = this.props.model['key-id-user'];\n        var fingerprintModel;\n        if (this.props.model['keypair-id-model'] > 0) {\n            fingerprintModel = this.props.model['key-id-model'];\n        } else {\n            fingerprintModel = \"\"\n        }\n        return (\n            <tr>\n                <td>\n                    {this.renderActions()}\n                </td>\n                <td className=\"overflow\" title={this.props.model.model}>\n                    <a href=\"\" onClick={this.copyToClipboard} data-key={this.props.model['api-key']} className=\"p-button--neutral small\" title={T('copy-api-key')}>\n                        <i className=\"fa fa-clipboard\" data-key={this.props.model['api-key']} /></a>\n                    &nbsp;\n                    {this.props.model.model}\n                </td>\n                <td className=\"overflow\" title={fingerprint} >{fingerprint}</td>\n                <td className=\"overflow\" title={fingerprintUser} >{fingerprintUser}</td>\n                <td>{this.props.model['key-active'] && this.props.model['key-active-user'] ? <i className=\"fa fa-check\"></i> :  <i className=\"fa fa-times\"></i>}</td>\n                <td className=\"overflow\" title={fingerprintModel} >\n                    <a href=\"\" className=\"p-button--neutral small\" title={T('assertion-settings')} data-key={this.props.model.id} onClick={this.props.showAssert}>\n                        <i className=\"fa fa-sliders\" aria-hidden=\"true\" data-key={this.props.model.id} />\n                    </a>                    \n                </td>\n            </tr>\n        )\n    }\n}\n\nexport default ModelRow;\n","/*\n * Copyright (C) 2016-2018 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Ajax from './Ajax';\n\nvar Keypair = {\n\turl: 'keypairs',\n\n\tlist: function () {\n\t\t\treturn Ajax.get(this.url);\n\t},\n\n\tget:  function(keypairId) {\n\t\treturn Ajax.get(this.url + '/' + keypairId, {});\n\t},\n\n\tupdate:  function(keypair) {\n\t\treturn Ajax.put(this.url + '/' + keypair.ID, keypair);\n\t},\n\n\tenable:  function(keypairId) {\n\t\treturn Ajax.post(this.url + '/' + keypairId + '/enable', {});\n\t},\n\n\tdisable:  function(keypairId) {\n\t\treturn Ajax.post(this.url + '/' + keypairId + '/disable', {});\n\t},\n\n\tcreate:  function(authorityId, key, keyName) {\n\t\treturn Ajax.post(this.url, {'authority-id': authorityId, 'private-key': key, 'key-name': keyName});\n\t},\n\n\tgenerate:  function(authorityId, keyName) {\n\t\treturn Ajax.post(this.url + '/generate', {'authority-id': authorityId, 'key-name': keyName});\n\t},\n\n\tstatus:  function() {\n\t\treturn Ajax.get(this.url + '/status');\n\t},\n\n\tassertion: function(keyId, assertion) {\n\t\treturn Ajax.post(this.url + '/assertion', {id: keyId, assertion: assertion});\n\t},\n\n\tregister: function(keypair) {\n\t\treturn Ajax.post(this.url + '/register', keypair);\n\t}\n}\n\nexport default Keypair;\n","/*\n * Copyright (C) 2016-2017 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Ajax from './Ajax';\n\nvar Models = {\n\turl: 'models',\n\n\tlist: function () {\n\t\treturn Ajax.get(this.url);\n\t},\n\n\tget: function(modelId) {\n\t\treturn Ajax.get(this.url + '/' + modelId);\n\t},\n\n\tupdate:  function(model) {\n\t\treturn Ajax.put(this.url + '/' + model.id, model);\n\t},\n\n\tdelete:  function(model) {\n\t\treturn Ajax.delete(this.url + '/' + model.id, {});\n\t},\n\n\tcreate:  function(model) {\n\t\treturn Ajax.post(this.url, model);\n\t},\n\n\tassertion:  function(modelAssertion) {\n\t\treturn Ajax.post(this.url + '/assertion', modelAssertion);\n\t},\n\n}\n\nexport default Models;\n","/*\n * Copyright (C) 2017-2018 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport React, {Component} from 'react';\nimport AlertBox from './AlertBox';\nimport Keypairs from '../models/keypairs';\nimport Models from '../models/models';\nimport {T, formatError, isUserAdmin} from './Utils';\n\nclass ModelAssertion extends Component {\n\n    constructor(props) {\n\n        super(props)\n\n        var assertion = {}\n        if ((this.props.model) && (this.props.model.assertion)) {\n            assertion = this.props.model.assertion\n        }\n        if (!assertion.model_id) {\n            assertion.model_id = this.props.model.id\n        }\n\n        this.state = {\n            error: null,\n            keypairs: [],\n            assertion: assertion,\n        }\n\n        this.getKeypairs();\n    }\n\n    getKeypairs() {\n        Keypairs.list().then((response) => {\n            var data = JSON.parse(response.body);\n            var message = \"\";\n            if (!data.success) {\n                message = data.message;\n            }\n\n            var keypairs = data.keypairs.filter( (k) => {\n                return k.AuthorityID === this.props.model['brand-id']\n            })\n\n            this.setState({keypairs: keypairs, message: message});\n        });\n    }\n\n    handleChangePrivateKeyModel = (e) => {\n        var assertion = this.state.assertion;\n        assertion['keypair_id'] = parseInt(e.target.value, 10);\n        this.setState({assertion: assertion});\n    }\n\n    handleChangeSeries = (e) => {\n        var assertion = this.state.assertion;\n        assertion['series'] = parseInt(e.target.value, 10);\n        this.setState({assertion: assertion});\n    }\n\n    handleChangeArchitecture = (e) => {\n        var assertion = this.state.assertion;\n        assertion['architecture'] = e.target.value;\n        this.setState({assertion: assertion});\n    }\n\n    handleChangeRevision = (e) => {\n        var assertion = this.state.assertion;\n        assertion['revision'] = parseInt(e.target.value, 10);\n        this.setState({assertion: assertion});\n    }\n\n    handleChangeBase = (e) => {\n        var assertion = this.state.assertion;\n        assertion['base'] = e.target.value;\n        this.setState({assertion: assertion});\n    }\n\n    handleChangeClassic = (e) => {\n        var assertion = this.state.assertion;\n        assertion['classic'] = e.target.value;\n        this.setState({assertion: assertion});\n    }\n\n    handleBlurClassic = (e) => {\n        var assertion = this.state.assertion;\n        switch (e.target.value.toLowerCase()) {\n        case '':\n            assertion['classic'] = ''\n            break\n        case 'false':\n            assertion['classic'] = 'false'\n            break\n        case 'no':\n            assertion['classic'] = 'false'\n            break\n        default:\n            assertion['classic'] = 'true'\n        }\n        this.setState({assertion: assertion});\n    }\n\n    handleChangeDisplayName = (e) => {\n        var assertion = this.state.assertion;\n        assertion['display_name'] = e.target.value;\n        this.setState({assertion: assertion});\n    }\n\n    handleChangeGadget = (e) => {\n        var assertion = this.state.assertion;\n        assertion['gadget'] = e.target.value;\n        this.setState({assertion: assertion});\n    }\n\n    handleChangeKernel = (e) => {\n        var assertion = this.state.assertion;\n        assertion['kernel'] = e.target.value;\n        this.setState({assertion: assertion});\n    }\n\n    handleChangeStore = (e) => {\n        var assertion = this.state.assertion;\n        assertion['store'] = e.target.value;\n        this.setState({assertion: assertion});\n    }\n\n    handleChangeSnaps = (e) => {\n        var assertion = this.state.assertion;\n        assertion['required_snaps'] = e.target.value;\n        this.setState({assertion: assertion});\n    }\n\n    handleSave = (e) => {\n        e.preventDefault()\n        if (!isUserAdmin(this.props.token)) {\n            window.location = '/models';\n        }\n\n        Models.assertion(this.state.assertion).then((response) => {\n            var data = JSON.parse(response.body);\n            console.log(data)\n            if (response.statusCode >= 300) {\n                this.setState({error: formatError(data)});\n            } else {\n                window.location = '/models';\n            }\n        })\n    }\n\n    render() {\n\n      var ma = this.state.assertion\n\n      return (\n        <tr>\n            <td colSpan=\"7\">\n                <h5>{T('assertion-settings')}</h5>\n                <AlertBox message={this.state.error} />\n                <form>\n                    <fieldset>\n                        <label htmlFor=\"keypair-model\">{T('private-key-model')}:\n                            <select value={ma.keypair_id} id=\"keypair-model\" onChange={this.handleChangePrivateKeyModel}>\n                                <option></option>\n                                {this.state.keypairs.map(function(kpr) {\n                                    if (kpr.Active) {\n                                        return <option key={kpr.ID} value={kpr.ID}>{kpr.AuthorityID}/{kpr.KeyID}</option>;\n                                    } else {\n                                        return <option key={kpr.ID} value={kpr.ID}>{kpr.AuthorityID}/{kpr.KeyID} ({T('inactive')})</option>;\n                                    }\n                                })}\n                            </select>\n                        </label>\n                        <label htmlFor=\"series\">{T('series')}:\n                            <input type=\"number\" id=\"series\" placeholder={T('series-description')} min=\"16\"\n                                value={ma['series']} onChange={this.handleChangeSeries} />\n                        </label>\n                        <label htmlFor=\"base\">{T('base')}:\n                            <input type=\"text\" id=\"base\" placeholder={T('base-description')}\n                                value={ma['base']} onChange={this.handleChangeBase} />\n                        </label>\n                        <label htmlFor=\"classic\">{T('classic')}:\n                            <input type=\"text\" id=\"classic\" placeholder={T('classic-description')}\n                                value={ma['classic']} onChange={this.handleChangeClassic} onBlur={this.handleBlurClassic} />\n                        </label>\n                        <label htmlFor=\"display_name\">{T('display_name')}:\n                            <input type=\"text\" id=\"display_name\" placeholder={T('display_name-description')}\n                                value={ma['display_name']} onChange={this.handleChangeDisplayName} />\n                        </label>\n                        <label htmlFor=\"architecture\">{T('architecture')}:\n                            <input type=\"text\" id=\"architecture\" placeholder={T('architecture-description')}\n                                value={ma['architecture']} onChange={this.handleChangeArchitecture} />\n                        </label>\n                        <label htmlFor=\"revision\">{T('revision')}:\n                            <input type=\"number\" id=\"revision\" placeholder={T('revision-description')}\n                                value={ma['revision']} onChange={this.handleChangeRevision} />\n                        </label>\n                        <label htmlFor=\"gadget\">{T('gadget')}:\n                            <input type=\"text\" id=\"gadget\" placeholder={T('gadget-description')}\n                                value={ma['gadget']} onChange={this.handleChangeGadget} />\n                        </label>\n                        <label htmlFor=\"kernel\">{T('kernel')}:\n                            <input type=\"text\" id=\"kernel\" placeholder={T('kernel-description')}\n                                value={ma['kernel']} onChange={this.handleChangeKernel} />\n                        </label>\n                        <label htmlFor=\"store\">{T('store')}:\n                            <input type=\"text\" id=\"store\" placeholder={T('store-description')}\n                                value={ma['store']} onChange={this.handleChangeStore} />\n                        </label>\n                        <label htmlFor=\"required-snaps\">{T('required-snaps')}:\n                            <textarea onChange={this.handleChangeSnaps} defaultValue={ma['required_snaps']} name=\"required-snaps\"\n                                placeholder={T('required-snaps-description')} />\n                        </label>\n                    </fieldset>\n                    {isUserAdmin(this.props.token) ?\n                      <span>\n                        <button className=\"p-button--neutral\" onClick={this.props.cancel} data-key={ma.model_id}>{T('cancel')}</button>\n                        <button className=\"p-button--brand\" onClick={this.handleSave} data-key={ma.model_id}>{T('save')}</button>\n                      </span>\n                     : <button className=\"p-button--neutral\" onClick={this.props.cancel} data-key={ma.model_id}>{T('close')}</button>\n                    }\n                </form>\n            </td>\n        </tr>\n      )\n    }\n}\n\nexport default ModelAssertion;\n","// -*- Mode: Go; indent-tabs-mode: t -*-\n\n/*\n * Copyright (C) 2016-2018 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport React, {Component} from 'react';\nimport ModelRow from './ModelRow';\nimport AlertBox from './AlertBox';\nimport ModelAssertion from './ModelAssertion';\nimport Models from '../models/models';\nimport {T, isUserAdmin} from './Utils'\n\n\nclass ModelList extends Component {\n\n  constructor(props) {\n\n    super(props)\n    this.state = {\n      confirmDelete: null,\n      message: null,\n      showAssert: null,\n    }\n  }\n\n  componentDidMount() {\n    this.refresh();\n  }\n\n  refresh() {\n\n  }\n\n  handleRefresh = () => {\n    this.refresh()\n  }\n\n  formatError(data) {\n    var message = T(data.error_code);\n    if (data.error_subcode) {\n      message += ': ' + T(data.error_subcode);\n    } else if (data.message) {\n      message += ': ' + data.message;\n    }\n    return message;\n  }\n\n  handleShowAssert = (e) => {\n    e.preventDefault();\n    var assertId = parseInt(e.target.getAttribute('data-key'), 10);\n    if (this.state.showAssert === assertId) {\n        this.setState({showAssert: null})\n    } else {\n        this.setState({showAssert: assertId})\n    }\n  }\n\n  handleDelete = (e) => {\n    e.preventDefault();\n    this.setState({confirmDelete: parseInt(e.target.getAttribute('data-key'), 10)});\n  }\n\n  handleDeleteModel = (e) => {\n    e.preventDefault();\n    var models = this.props.models.filter((mdl) => {\n      return mdl.id === this.state.confirmDelete;\n    });\n    if (models.length === 0) {\n      return;\n    }\n\n    Models.delete(models[0]).then((response) => {\n      var data = JSON.parse(response.body);\n      if ((response.statusCode >= 300) || (!data.success)) {\n        this.setState({message: this.formatError(data)});\n      } else {\n        window.location = '/models';\n      }\n    });\n  }\n\n  handleDeleteModelCancel = (e) => {\n    e.preventDefault();\n    this.setState({confirmDelete: null});\n  }\n\n  renderTable() {\n\n    if (this.props.models.length > 0) {\n      return (\n        <table>\n          <thead>\n            <tr>\n              <th></th><th>{T('model')}</th><th>{T('private-key-short')}</th><th>{T('private-key-user-short')}</th>\n              <th className=\"small\">{T('active')}</th>\n              <th>{T('private-key-model-short')}</th>\n            </tr>\n          </thead>\n            {this.props.models.map((mdl) => {\n              return (\n                <tbody>\n                  <ModelRow key={mdl.id} model={mdl} delete={this.handleDelete} confirmDelete={this.state.confirmDelete}\n                      deleteModel={this.handleDeleteModel} cancelDelete={this.handleDeleteModelCancel} showAssert={this.handleShowAssert} />\n\n                  {this.state.showAssert === mdl.id ? <ModelAssertion model={mdl} token={this.props.token} cancel={this.handleShowAssert} /> : ''}\n                </tbody>\n              );\n            })}\n        </table>\n      );\n    } else {\n      return (\n        <p>No models found.</p>\n      );\n    }\n  }\n\n  render() {\n    if (!isUserAdmin(this.props.token)) {\n      return (\n        <div className=\"row\">\n          <AlertBox message={T('error-no-permissions')} />\n        </div>\n      )\n    }\n\n    return (\n        <div className=\"row\">\n\n          <section className=\"row\">\n            <div className=\"u-equal-height\">\n              <h2 className=\"col-3\">{T('models')}</h2>\n              &nbsp;\n              <div className=\"col-1\">\n                <a href=\"/models/new\" className=\"p-button--brand\" title={T('add-new-model')}>\n                  <i className=\"fa fa-plus\"></i>\n                </a>\n              </div>\n            </div>\n            <div className=\"col-12\">\n              <p>{T('models_available')}:</p>\n            </div>\n            <div className=\"col-12\">\n              <AlertBox message={this.state.message} />\n            </div>\n            <div className=\"col-12\">\n              {this.renderTable()}\n            </div>\n          </section>\n\n        </div>\n    );\n  }\n}\n\nexport default ModelList;\n","/*\n * Copyright (C) 2016-2018 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport React, {Component} from 'react';\nimport AlertBox from './AlertBox';\nimport Models from '../models/models';\nimport {T, isUserAdmin} from './Utils';\n\nclass ModelEdit extends Component {\n\n    constructor(props) {\n\n        super(props)\n        this.state = {\n            title: null,\n            model: {'brand-id': this.props.selectedAccount.AuthorityID},\n            error: null,\n            hideForm: false,\n        }\n    }\n\n    componentDidMount() {\n        if (this.props.id) {\n            this.setTitle('edit-model');\n            this.getModel(this.props.id);\n        } else {\n            this.setTitle('new-model');\n        }\n    }\n\n    setTitle(title) {\n        this.setState({title: T(title)});\n    }\n\n    getModel(modelId) {\n        Models.get(modelId).then((response) => {\n            var data = JSON.parse(response.body);\n\n            if (response.statusCode >= 300) {\n                this.setState({error: this.formatError(data), hideForm: true});\n            } else {\n                this.setState({model: data.model, hideForm: false});\n            }\n        });\n    }\n\n    formatError(data) {\n        var message = T(data.error_code);\n        if (data.error_subcode) {\n            message += ': ' + T(data.error_subcode);\n        }\n        if (data.message) {\n            message += ': ' + data.message;\n        }\n        return message;\n    }\n\n    handleChangeBrand = (e) => {\n        var model = this.state.model;\n        model['brand-id'] = e.target.value;\n        this.setState({model: model});\n    }\n\n    handleChangeModel = (e) => {\n        var model = this.state.model;\n        model.model = e.target.value;\n        this.setState({model: model});\n    }\n\n    handleChangeAPIKey = (e) => {\n        var model = this.state.model;\n        model['api-key'] = e.target.value;\n        this.setState({model: model});\n    }\n\n    handleChangePrivateKey = (e) => {\n        var model = this.state.model;\n        model['keypair-id'] = parseInt(e.target.value, 10);\n        this.setState({model: model});\n    }\n\n    handleChangePrivateKeyUser = (e) => {\n        var model = this.state.model;\n        model['keypair-id-user'] = parseInt(e.target.value, 10);\n        this.setState({model: model});\n    }\n\n    handleSaveClick = (e) => {\n        e.preventDefault();\n        var self = this;\n\n        if (this.state.model.id) {\n            // Update the existing model\n            Models.update(this.state.model).then(function(response) {\n                var data = JSON.parse(response.body);\n                if (response.statusCode >= 300) {\n                    self.setState({error: self.formatError(data)});\n                } else {\n                    window.location = '/models';\n                }\n            });\n        } else {\n            // Create a new model\n            Models.create(this.state.model).then(function(response) {\n                var data = JSON.parse(response.body);\n                if (response.statusCode >= 300) {\n                    self.setState({error: self.formatError(data)});\n                } else {\n                    window.location = '/models';\n                }\n            });\n        }\n    }\n\n    renderError() {\n        if (this.state.error) {\n            return (\n                <AlertBox message={this.state.error} />\n            );\n        }\n    }\n\n    render() {\n\n        if (!isUserAdmin(this.props.token)) {\n            return (\n                <div className=\"row\">\n                <AlertBox message={T('error-no-permissions')} />\n                </div>\n            )\n        }\n\n        if (this.state.hideForm) {\n            return (\n                <div className=\"row\">\n                <AlertBox message={this.state.error} />\n                </div>\n            )\n        }\n\n        return (\n            <div className=\"row\">\n                <section className=\"row\">\n                      <h2>{this.state.title}</h2>\n\n                        <AlertBox message={this.state.error} />\n\n                        <form>\n                            <fieldset>\n                                <label htmlFor=\"brand\">{T('brand')}:\n                                    <input type=\"text\" id=\"brand\" placeholder={T('brand-description')} disabled\n                                        value={this.state.model['brand-id']} onChange={this.handleChangeBrand} />\n                                </label>\n                                <label htmlFor=\"model\">{T('model')}:\n                                    <input type=\"text\" id=\"model\" placeholder={T('model-description')}\n                                        value={this.state.model.model} onChange={this.handleChangeModel}/>\n                                </label>\n                                <label htmlFor=\"model\">{T('api-key')}:\n                                    <input type=\"text\" id=\"api-key\" placeholder={T('api-key-description')}\n                                        value={this.state.model['api-key']} onChange={this.handleChangeAPIKey}/>\n                                </label>\n                                <label htmlFor=\"keypair\">{T('private-key')}:\n                                    <select value={this.state.model['keypair-id']} id=\"keypair\" onChange={this.handleChangePrivateKey}>\n                                        <option />\n                                        {this.props.keypairs.map((kpr) => {\n                                            if (kpr.Active) {\n                                                return <option key={kpr.ID} value={kpr.ID}>{kpr.KeyName} - {kpr.KeyID}</option>;\n                                            } else {\n                                                return <option key={kpr.ID} value={kpr.ID}>{kpr.KeyName} - {kpr.KeyID} ({T('inactive')})</option>;\n                                            }\n                                        })}\n                                    </select>\n                                </label>\n                                <label htmlFor=\"keypair-user\">{T('private-key-user')}:\n                                    <select value={this.state.model['keypair-id-user']} id=\"keypair-user\" onChange={this.handleChangePrivateKeyUser}>\n                                        <option></option>\n                                        {this.props.keypairs.map((kpr) => {\n                                            if (kpr.Active) {\n                                                return <option key={kpr.ID} value={kpr.ID}>{kpr.KeyName} - {kpr.KeyID}</option>;\n                                            } else {\n                                                return <option key={kpr.ID} value={kpr.ID}>{kpr.KeyName} - {kpr.KeyID} ({T('inactive')})</option>;\n                                            }\n                                        })}\n                                    </select>\n                                </label>\n                            </fieldset>\n                        </form>\n\n                        <div>\n                            <a href='/models' className=\"p-button--neutral\">{T('cancel')}</a>\n                            &nbsp;\n                            <a href='/models' onClick={this.handleSaveClick} className=\"p-button--brand\">{T('save')}</a>\n                        </div>\n                </section>\n                <br />\n            </div>\n        )\n    }\n}\n\nexport default ModelEdit;\n","/*\n * Copyright (C) 2016-2018 Canonical Ltd\n * License granted by Canonical Limited\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport React, {Component} from 'react'\nimport Keypairs from '../models/keypairs'\nimport AlertBox from './AlertBox'\nimport {T, isUserAdmin} from './Utils';\n\nclass KeypairAdd extends Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            name: null,\n            key: null,\n            error: this.props.error,\n        };\n    }\n\n    getAccounts() {\n        if (this.props.selectedAccount.ID) {\n            return [this.props.selectedAccount]\n        } else {\n            return []\n        }\n    }\n\n    handleChangeAuthorityId = (e) => {\n        this.setState({authorityId: e.target.value});\n    }\n\n    handleChangeKeyName = (e) => {\n        this.setState({name: e.target.value});\n    }\n\n    handleChangeKey = (e) => {\n        this.setState({key: e.target.value});\n    }\n\n    handleFileUpload = (e) => {\n        var self = this;\n        var reader = new FileReader();\n        var file = e.target.files[0];\n\n        reader.onload = function(upload) {\n        self.setState({\n            key: upload.target.result.split(',')[1],\n        });\n        }\n\n        reader.readAsDataURL(file);\n    }\n\n    handleSaveClick = (e) => {\n        e.preventDefault();\n\n        Keypairs.create(this.props.selectedAccount.AuthorityID, this.state.key, this.state.name).then((response) => {\n            var data = JSON.parse(response.body);\n            if ((response.statusCode >= 300) || (!data.success)) {\n                this.setState({error: this.formatError(data)});\n            } else {\n                window.location = '/signing-keys';\n            }\n        });\n    }\n\n    formatError = (data) => {\n        var message = T(data.error_code);\n        if (data.error_subcode) {\n            message += ': ' + T(data.error_subcode);\n        } else if (data.message) {\n            message += ': ' + data.message;\n        }\n        return message;\n    }\n\n    render() {\n\n        if (!isUserAdmin(this.props.token)) {\n            return (\n                <div className=\"row\">\n                <AlertBox message={T('error-no-permissions')} />\n                </div>\n            )\n        }\n\n        return (\n            <div>\n                <section className=\"row no-border\">\n                    <h2>{T('new-signing-key')}</h2>\n                    <div className=\"col-12\">\n                        <AlertBox message={this.state.error} />\n\n                        <form>\n                            <fieldset>\n                                <label htmlFor=\"name\">{T('key-name')}:\n                                    <input type=\"text\" id=\"name\" onChange={this.handleChangeKeyName} value={this.state.name} placeholder={T('key-name-description')} />\n                                </label>\n                                <label htmlFor=\"authority-id\">{T('authority-id')}:\n                                    <select value={this.props.selectedAccount.AuthorityID} id=\"authority-id\" onChange={this.handleChangeAuthorityId}>\n                                        {this.getAccounts().map(function(a) {\n                                            return <option key={a.AuthorityID} value={a.AuthorityID}>{a.AuthorityID}</option>;\n                                        })}\n                                    </select>\n                                </label>\n                                <label htmlFor=\"key\">{T('signing-key')}:\n                                    <textarea onChange={this.handleChangeKey} defaultValue={this.state.key} id=\"key\"\n                                            placeholder={T('new-signing-key-description')}>\n                                    </textarea>\n                                    <input type=\"file\" onChange={this.handleFileUpload} />\n                                </label>\n                            </fieldset>\n                        </form>\n                        <div>\n                            <a href='/signing-keys' className=\"p-button--neutral\">{T('cancel')}</a>\n                            &nbsp;\n                            <a href='/signing-keys' onClick={this.handleSaveClick} className=\"p-button--brand\">{T('save')}</a>\n                        </div>\n                    </div>\n                </section>\n                <br />\n            </div>\n        );\n    }\n}\n\nexport default KeypairAdd;\n","/*\n * Copyright (C) 2018 Canonical Ltd\n * License granted by Canonical Limited\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport React, {Component} from 'react'\nimport Keypairs from '../models/keypairs'\nimport AlertBox from './AlertBox'\nimport {T, isUserAdmin} from './Utils';\n\nclass KeypairEdit extends Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            keypair: {},\n            error: null,\n        };\n\n        this.getKeypair(this.props.id)\n    }\n\n    getKeypair(keyId) {\n        Keypairs.get(keyId).then((response) => {\n            var data = JSON.parse(response.body);\n\n            if (response.statusCode >= 300) {\n                this.setState({error: this.formatError(data), hideForm: true});\n            } else {\n                this.setState({keypair: data.keypair, hideForm: false});\n            }\n        });\n    }\n\n    handleChangeKeyName = (e) => {\n        var k = this.state.keypair\n        k.KeyName = e.target.value\n        this.setState({keypair: k});\n    }\n\n    handleSaveClick = (e) => {\n        e.preventDefault();\n\n        Keypairs.update(this.state.keypair).then((response) => {\n            var data = JSON.parse(response.body);\n            if ((response.statusCode >= 300) || (!data.success)) {\n                this.setState({error: this.formatError(data)});\n            } else {\n                window.location = '/signing-keys';\n            }\n        });\n    }\n\n    formatError = (data) => {\n        var message = T(data.error_code);\n        if (data.error_subcode) {\n            message += ': ' + T(data.error_subcode);\n        } else if (data.message) {\n            message += ': ' + data.message;\n        }\n        return message;\n    }\n\n    render() {\n\n        if (!isUserAdmin(this.props.token)) {\n            return (\n                <div className=\"row\">\n                <AlertBox message={T('error-no-permissions')} />\n                </div>\n            )\n        }\n\n        if (this.state.hideForm) {\n            return (\n                <div className=\"row\">\n                <AlertBox message={this.state.error} />\n                </div>\n            )\n        }\n\n        return (\n            <div className=\"row\">\n                <section className=\"row\">\n                      <h2>{T('edit-signing-key')}</h2>\n\n                        <AlertBox message={this.state.error} />\n                        <form>\n                            <fieldset>\n                                <label htmlFor=\"name\">{T('key-name')}:\n                                    <input type=\"text\" id=\"name\" onChange={this.handleChangeKeyName} value={this.state.keypair.KeyName} placeholder={T('key-name-description')} />\n                                </label>\n\n                                <label htmlFor=\"authority-id\">{T('authority-id')}:\n                                    <input type=\"text\" id=\"authority-id\" placeholder={T('authority-id-description')}\n                                        value={this.state.keypair.AuthorityID} disabled />\n                                </label>\n                            </fieldset>\n                        </form>\n                        <div>\n                            <a href='/signing-keys' className=\"p-button--neutral\">{T('cancel')}</a>\n                            &nbsp;\n                            <a href='/signing-keys' onClick={this.handleSaveClick} className=\"p-button--brand\">{T('save')}</a>\n                        </div>\n                </section>\n            </div>\n        )\n\n    }\n\n}\n\nexport default KeypairEdit;\n","/*\n * Copyright (C) 2017-2018 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport React, {Component} from 'react'\nimport Keypairs from '../models/keypairs'\nimport AlertBox from './AlertBox'\nimport {T, isUserAdmin} from './Utils';\n\nclass KeypairGenerate extends Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            keyName: null, \n            error: this.props.error,\n        };\n    }\n\n    getAccounts() {\n        if (this.props.selectedAccount.ID) {\n            return [this.props.selectedAccount]\n        } else {\n            return []\n        }\n    }\n\n    handleChangeAuthorityId = (e) => {\n        this.setState({authorityId: e.target.value});\n    }\n\n    handleChangeKeyName = (e) => {\n        this.setState({keyName: e.target.value});\n    }\n\n    handleSaveClick = (e) => {\n        var self = this;\n        e.preventDefault();\n\n        Keypairs.generate(this.props.selectedAccount.AuthorityID, this.state.keyName).then(function(response) {\n            var data = JSON.parse(response.body);\n            if ((response.statusCode >= 300) || (!data.success)) {\n        self.setState({error: self.formatError(data)});\n      } else {\n        window.location = '/signing-keys';\n      }\n        });\n    }\n\n    formatError = (data) => {\n        var message = T(data.error_code);\n        if (data.error_subcode) {\n            message += ': ' + T(data.error_subcode);\n        } else if (data.message) {\n            message += ': ' + data.message;\n        }\n        return message;\n    }\n\n    render() {\n\n        if (!isUserAdmin(this.props.token)) {\n            return (\n                <div className=\"row\">\n                <AlertBox message={T('error-no-permissions')} />\n                </div>\n            )\n        }\n\n        return (\n            <div>\n                <section className=\"row no-border\">\n                    <h2>{T('generate-signing-key')}</h2>\n                    <div className=\"col-12\">\n                        <AlertBox message={this.state.error} />\n\n                        <form>\n                            <fieldset>\n                                <label htmlFor=\"authority-id\">{T('authority-id')}:\n                                    <select value={this.props.selectedAccount.AuthorityID} id=\"authority-id\" onChange={this.handleChangeAuthorityId}>\n                                        {this.getAccounts().map(function(a) {\n                                            return <option key={a.AuthorityID} value={a.AuthorityID}>{a.AuthorityID}</option>;\n                                        })}\n                                    </select>\n                                </label>                                \n                                <label htmlFor=\"key-name\">{T('key-name')}:\n                                    <input type=\"text\" id=\"key-name\" onChange={this.handleChangeKeyName} placeholder={T('key-name-description')} />\n                                </label>\n\n                            </fieldset>\n                        </form>\n                        <div>\n                            <a href='/signing-keys' className=\"p-button--neutral\">{T('cancel')}</a>\n                            &nbsp;\n                            <a href='/signing-keys' onClick={this.handleSaveClick} className=\"p-button--brand\">{T('generate')}</a>\n                        </div>\n                    </div>\n                </section>\n                <br />\n            </div>\n        );\n    }\n}\n\nexport default KeypairGenerate;\n","/*\n * Copyright (C) 2016-2018 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport React, {Component} from 'react';\nimport Keypairs from '../models/keypairs';\nimport AlertBox from './AlertBox';\nimport {T, formatError, isUserAdmin} from './Utils'\n\n\nclass KeypairStore extends Component {\n    constructor(props) {\n        super(props)\n\n        var k = {}\n        if (this.props.keypairs.length > 0) {\n            k = this.keyFromKeypair(this.props.keypairs[0]);\n        }\n\n        this.state = {\n            keypair: k\n        }\n    }\n\n    keyFromKeypair (keypair) {\n        return {'authority-id': keypair.AuthorityID, 'key-name': keypair.KeyName}\n    }\n\n    handleChangeKey = (e) => {\n        var id = parseInt(e.target.value, 10);\n        var keys = this.props.keypairs.filter((k) => {\n            return k.ID === id\n        })\n        if (keys.length > 0) {\n            var k = this.keyFromKeypair(keys[0])\n            this.setState({keypair: k})\n        }\n    }\n\n    handleChangeName = (e) => {\n        var keypair = this.state.keypair\n        keypair.KeyName = e.target.value\n        this.setState({keypair: keypair})\n    }\n\n    handleChangeEmail = (e) => {\n        var keypair = this.state.keypair\n        keypair.email = e.target.value\n        this.setState({keypair: keypair})\n    }\n\n    handleChangePassword = (e) => {\n        var keypair = this.state.keypair\n        keypair.password = e.target.value\n        this.setState({keypair: keypair})\n    }\n\n    handleChangeOTP = (e) => {\n        var keypair = this.state.keypair\n        keypair.otp = e.target.value\n        this.setState({keypair: keypair})\n    }\n\n    handleSaveClick = (e) => {\n        e.preventDefault()\n\n        Keypairs.register(this.state.keypair).then((response) => {\n            var data = JSON.parse(response.body);\n            if ((response.statusCode >= 300) || (!data.success)) {\n                this.setState({error: formatError(data)});\n            } else {\n                window.location = '/signing-keys';\n            }\n        });\n    }\n\n    render() {\n        if (!isUserAdmin(this.props.token)) {\n            return (\n              <div className=\"row\">\n                <AlertBox message={T('error-no-permissions')} />\n              </div>\n            )\n        }\n\n        return (\n            <div>\n                <section className=\"row no-border\">\n                    <h2>{T('register-signing-key')}</h2>\n                    <div className=\"col-12\">\n                        <AlertBox message={this.state.error} />\n\n                        <form>\n                            <fieldset>\n\n                                <label htmlFor=\"keypair\">{T('signing-key')}:\n                                    <select value={this.state.keypair.ID} id=\"keypair\" onChange={this.handleChangeKey}>\n                                        <option />\n                                        {this.props.keypairs.map((kpr) => {\n                                            if (kpr.Active) {\n                                                return <option key={kpr.ID} value={kpr.ID}>{kpr.AuthorityID}/{kpr.KeyID}</option>;\n                                            } else {\n                                                return <option key={kpr.ID} value={kpr.ID}>{kpr.AuthorityID}/{kpr.KeyID} ({T('inactive')})</option>;\n                                            }\n                                        })}\n                                    </select>\n                                </label>\n\n                                <label htmlFor=\"key-name\">{T('key-name')}:\n                                    <input type=\"text\" id=\"key-name\" onChange={this.handleChangeName} placeholder={T('key-name-description')} value={this.state.keypair['key-name']} />\n                                </label>\n\n                                <h3>{T('store-credentials')}</h3>\n                                <label htmlFor=\"email\">{T('email')}:\n                                    <input type=\"email\" id=\"email\" onChange={this.handleChangeEmail} placeholder={T('email-description')} value={this.state.keypair.email} />\n                                </label>\n                                <label htmlFor=\"password\">{T('password')}:\n                                    <input type=\"password\" id=\"password\" onChange={this.handleChangePassword} placeholder={T('password-description')} value={this.state.keypair.password} />\n                                </label>\n                                <label htmlFor=\"otp\">{T('otp')}:\n                                    <input type=\"text\" id=\"otp\" onChange={this.handleChangeOTP} placeholder={T('otp-description')} value={this.state.keypair.otp} />\n                                </label>\n                            </fieldset>\n                        </form>\n                        <div>\n                            <a href='/signing-keys' className=\"p-button--neutral\">{T('cancel')}</a>\n                            &nbsp;\n                            <a href='/signing-keys' onClick={this.handleSaveClick} className=\"p-button--brand\">{T('save')}</a>\n                        </div>\n                    </div>\n                </section>\n                <br />\n            </div>\n        );\n\n    }\n}\n\nexport default KeypairStore;\n","/*\n * Copyright (C) 2017-2018 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport React, {Component} from 'react'\nimport Models from '../models/models'\nimport AlertBox from './AlertBox'\nimport {T, isUserAdmin} from './Utils'\n\nclass AccountList extends Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            //keypairs: props.keypairs || [],\n            models: props.models || [],\n            message: '',\n        }\n    }\n\n    componentDidMount() {\n        this.getModels()\n    }\n\n    getAccounts() {\n        if (this.props.selectedAccount.ID) {\n            return [this.props.selectedAccount]\n        } else {\n            return []\n        }\n    }\n\n    getModels() {\n        Models.list().then((response) => {\n            var data = JSON.parse(response.body);\n            var message = \"\";\n            if (!data.success) {\n                message = data.message;\n            }\n            this.setState({models: data.models, message: message});\n        });\n    }\n\n    // Indicates whether the key has everything uploaded for it\n    renderKeyStatus(acc) {\n        // Check if the key is used for signing system-users on any models\n        if (!this.state.models.find(m => (m['authority-id-user'] === acc.AuthorityID) & (m['key-id-user'] === acc.KeyID))) {\n            return <p>{T('not-used-signing')}</p>\n        }\n\n        // Check that we have an account assertion\n        var messages = []\n        if (!this.getAccounts().find(a => a.AuthorityID === acc.AuthorityID)) {\n            messages.push(T('no-assertion'))\n        }\n\n        // Check if we have an account key assertion\n        if ((!acc.Assertion) || (acc.Assertion.length === 0)) {\n            messages.push(T('no-assertion-key'))\n        }\n        \n        if (messages.length === 0) {\n            return (\n                <div>\n                    <p title={acc.Assertion}><i className=\"fa fa-check information positive\"></i> {T('complete')}</p>\n                </div>\n            )\n        }\n\n        return (\n            <div>\n                {messages.map((m, index, array) => {\n                    return (\n                        <p key={index}><i className=\"fa fa-exclamation-triangle warning\"></i> {m}</p>\n                    )\n                })}\n            </div>\n        )\n    }\n\n    renderAccounts() {\n        if (this.getAccounts().length > 0) {\n            return (\n                <table>\n                <thead>\n                    <tr>\n                        {isUserAdmin(this.props.token) ? <th className=\"small\"></th> : ''}\n                        <th>{T('account')}</th><th>{T('assertion-status')}</th><th className=\"small\">{T('reseller')}</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    {this.getAccounts().map((acc) => {\n                    return (\n                        <tr key={acc.ID}>\n                            {isUserAdmin(this.props.token) ? \n                                <td>\n                                    <div>\n                                    <a href={'/accounts/account/' + acc.ID} className=\"p-button--brand small\" title={T('edit-account')}><i className=\"fa fa-pencil\"></i></a>\n                                    </div>\n                                </td>\n                                : ''\n                            }\n                            <td>{acc.AuthorityID}</td>\n                            <td>\n                                <p title={acc.Assertion}><i className=\"fa fa-check information positive\"></i> {T('complete')}</p>\n                            </td>\n                            <td>{acc.ResellerAPI ? <i className=\"fa fa-check\"></i> :  <i className=\"fa fa-times\"></i>}</td>\n                        </tr>\n                    );\n                    })}\n                </tbody>\n                </table>\n            );\n        } else {\n            return (\n                <p>{T('no-assertions')}</p>\n            );\n        }\n    }\n\n    renderAccountKeys() {\n        if (this.props.keypairs.length > 0) {\n            return (\n                <table>\n                <thead>\n                    <tr>\n                        <th>{T('key-id')}</th><th>{T('assertion-status')}</th><th className=\"small\">{T('reseller')}</th>\n                    </tr>\n                </thead>\n                <tbody>\n                    {this.props.keypairs.map((acc) => {\n                    return (\n                        <tr key={acc.ID}>\n                            <td className=\"overflow\">\n                                {acc.AuthorityID}<br />{acc.KeyID}\n                            </td>\n                            <td>\n                                {this.renderKeyStatus(acc)}\n                            </td>\n                            <td>{acc.ResellerAPI ? <i className=\"fa fa-check\"></i> :  <i className=\"fa fa-times\"></i>}</td>\n                        </tr>\n                    );\n                    })}\n                </tbody>\n                </table>\n            );\n        } else {\n            return (\n                <p>{T('no-assertions')}</p>\n            );\n        }\n    }\n\n    render() {\n        if (!isUserAdmin(this.props.token)) {\n            return (\n                <div className=\"row\">\n                <AlertBox message={T('error-no-permissions')} />\n                </div>\n            )\n        }\n\n        return (\n            <div className=\"row\" ref=\"root\">\n                <section className=\"row\">\n\n                    <div className=\"u-equal-height\">\n                        <h2 className=\"col-5\">{T('accounts')}</h2>\n                        &nbsp;\n                        <div className=\"col-1\">\n                            <a href=\"/accounts/new\" className=\"p-button--brand\" title={T('new-account-assertion')}>\n                                <i className=\"fa fa-plus\"></i>\n                            </a>\n                        </div>\n                        <div className=\"col-1\">\n                            <a href=\"/accounts/upload\" className=\"p-button--brand\" title={T('upload-account-assertion')}>\n                                <i className=\"fa fa-upload\"></i>\n                            </a>\n                        </div>\n                    </div>\n\n                    <div className=\"col-12\">\n                        {this.renderAccounts()}\n                    </div>\n                </section>\n\n                <section className=\"row\">\n                    <div className=\"u-equal-height\">\n                        <h2 className=\"col-5\">{T('account-keys')}</h2>\n                        &nbsp;\n                        <div className=\"col-1\">\n                            <a href=\"/accounts/key-assertion\" className=\"p-button--brand\" title={T('new-account-assertion')}>\n                                <i className=\"fa fa-plus\"></i>\n                            </a>\n                        </div>\n                    </div>\n\n                    <div className=\"col-12\">\n                        {this.renderAccountKeys()}\n                    </div>\n                </section>\n            </div>\n        )\n    }\n\n}\n\nexport default AccountList\n","/*\n * Copyright (C) 2016-2017 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Ajax from './Ajax'\n\nvar Account = {\n    url: 'accounts',\n\n    list() {\n        return Ajax.get(this.url);\n    },\n\n    get(id) {\n        return Ajax.get(this.url + '/' + id);\n    },\n\n    create(account) {\n        return Ajax.post(this.url, account);\n    },\n\n    update(account) {\n        return Ajax.put(this.url + '/' + account.ID, account);\n    },\n\n    upload(assertion) {\n        return Ajax.post(this.url + '/upload', {assertion: assertion});\n    },\n\n    stores(id) {\n        return Ajax.get(this.url + '/' + id + '/stores');\n    },\n\n    storeNew(accountID, store) {\n        store.accountID = parseInt(accountID, 10)\n        return Ajax.post(this.url + '/stores', store);\n    },\n\n    storeUpdate(store) {\n        return Ajax.put(this.url + '/stores/' + store.id, store);\n    },\n\n    storeDelete(store) {\n        return Ajax.delete(this.url + '/stores/' + store.id, {});\n    }\n}\n\nexport default Account\n","/*\n * Copyright (C) 2017-2018 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport React, {Component} from 'react'\nimport  AlertBox from './AlertBox'\nimport Accounts from '../models/accounts'\nimport {T, parseResponse, formatError, isUserAdmin} from './Utils';\n\nclass AccountForm extends Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            assertion: null,\n            error: null,\n        }\n    }\n\n    handleFileUpload = (e) => {\n        var reader = new FileReader();\n        var file = e.target.files[0];\n\n        reader.onload = (upload) => {\n            this.setState({\n                assertion: upload.target.result.split(',')[1],\n            });\n        }\n\n        reader.readAsDataURL(file);\n    }\n\n    handleSaveClick = (e) => {\n        e.preventDefault();\n\n        Accounts.upload(this.state.assertion).then((response) => {\n            var data = parseResponse(response)\n            if (!data.success) {\n                this.setState({error: formatError(data)});\n            } else {\n                window.location = '/accounts';\n            }\n        });\n    }\n\n    render() {\n        if (!isUserAdmin(this.props.token)) {\n            return (\n                <div className=\"row\">\n                <AlertBox message={T('error-no-permissions')} />\n                </div>\n            )\n        }\n\n        return (\n            <div>\n\n                <section className=\"row no-border\">\n                    <h2>{T('new-account-assertion')}</h2>\n                    <div className=\"col-12\">\n                        <AlertBox message={this.state.error} />\n\n                        <form>\n                            <fieldset>\n                                <label htmlFor=\"key\">{T('assertion')}:\n                                    <input type=\"file\" onChange={this.handleFileUpload} />\n                                </label>\n                            </fieldset>\n                        </form>\n                        <div>\n                            <a href='/accounts' className=\"p-button--neutral\">{T('cancel')}</a>\n                            &nbsp;\n                            <a href='/accounts' onClick={this.handleSaveClick} className=\"p-button--brand\">{T('save')}</a>\n                        </div>\n                    </div>\n                </section>\n                <br />\n            </div>\n        );\n    }\n\n}\n\nexport default AccountForm","/*\n * Copyright (C) 2017-2018 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport React, {Component} from 'react'\nimport  AlertBox from './AlertBox'\nimport Accounts from '../models/accounts'\nimport {T, parseResponse, formatError, isUserAdmin} from './Utils';\n\nclass AccountEdit extends Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            account: {},\n            error: null,\n        }\n\n        if (this.props.id) {\n            this.getAccount(this.props.id)\n        }\n    }\n\n    getAccount(accountId) {\n        Accounts.get(accountId).then((response) => {\n            var data = JSON.parse(response.body);\n\n            if (response.statusCode >= 300) {\n                this.setState({error: this.formatError(data), hideForm: true});\n            } else {\n                this.setState({account: data.account, hideForm: false});\n            }\n        });\n    }\n\n    handleChangeAccount = (e) => {\n        var a = this.state.account\n        a.AuthorityID = e.target.value\n        this.setState({account: a})\n    }\n\n    handleChangeReseller = (e) => {\n        var a = this.state.account;\n        a.ResellerAPI = e.target.checked;\n        this.setState({account: a});\n    }\n\n    handleSaveClick = (e) => {\n        e.preventDefault();\n\n        if (this.state.account.ID) {\n            Accounts.update(this.state.account).then((response) => {\n                var data = parseResponse(response)\n                if (!data.success) {\n                    this.setState({error: formatError(data)});\n                } else {\n                    window.location = '/accounts';\n                }\n            });\n        } else {\n            Accounts.create(this.state.account).then((response) => {\n                var data = parseResponse(response)\n                if (!data.success) {\n                    this.setState({error: formatError(data)});\n                } else {\n                    window.location = '/accounts';\n                }\n            });\n        }\n    }\n\n    render() {\n        if (!isUserAdmin(this.props.token)) {\n            return (\n                <div className=\"row\">\n                <AlertBox message={T('error-no-permissions')} />\n                </div>\n            )\n        }\n\n        return (\n            <div>\n\n                <section className=\"row no-border\">\n                    <h2>{T('store-account-assertion')}</h2>\n                    <div className=\"col-12\">\n                        <AlertBox message={this.state.error} />\n\n                        <form>\n                            <fieldset>\n                                <label htmlFor=\"account\">{T('account')}:\n                                    <input type=\"text\" id=\"account\" onChange={this.handleChangeAccount} value={this.state.account.AuthorityID} placeholder={T('account-description')} />\n                                </label>\n                                <label htmlFor=\"reseller\">{T('reseller-features')}\n                                    <input className=\"visible\" type=\"checkbox\" id=\"reseller\" onChange={this.handleChangeReseller} checked={this.state.account.ResellerAPI} />\n                                </label>\n                            </fieldset>\n                        </form>\n                        <div>\n                            <a href='/accounts' className=\"p-button--neutral\">{T('cancel')}</a>\n                            &nbsp;\n                            <a href='/accounts' onClick={this.handleSaveClick} className=\"p-button--brand\">{T('save')}</a>\n                        </div>\n                        {this.props.id? \n                            <label htmlFor=\"assertion\">{T('assertion')}:\n                                <pre>{this.state.account.Assertion}</pre>\n                            </label>\n                        :   ''\n                        }\n                    </div>\n                </section>\n                <br />\n            </div>\n        );\n    }\n\n}\n\nexport default AccountEdit","/*\n * Copyright (C) 2017-2018 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport React, {Component} from 'react'\nimport  AlertBox from './AlertBox'\nimport Keypairs from '../models/keypairs'\nimport {T, parseResponse, formatError, isUserAdmin} from './Utils';\n\nclass AccountKeyForm extends Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            keypairs: props.keypairs || [],\n            keypairId: 0,\n            assertion: null,\n            error: null\n        }\n\n        this.getKeypairs()\n    }\n\n    getKeypairs() {\n        Keypairs.list().then((response) => {\n            var data = JSON.parse(response.body);\n            var message = \"\";\n            if (!data.success) {\n                message = data.message;\n            }\n            this.setState({keypairs: data.keypairs, message: message});\n        });\n    }\n\n    handleChangeKeypair = (e) => {\n        e.preventDefault();\n        this.setState({keypairId: parseInt(e.target.value, 10)})\n    }\n\n    handleFileUpload = (e) => {\n        var reader = new FileReader();\n        var file = e.target.files[0];\n\n        reader.onload = (upload) => {\n            this.setState({\n                assertion: upload.target.result.split(',')[1],\n            });\n        }\n\n        reader.readAsDataURL(file);\n    }\n\n    handleSaveClick = (e) => {\n        e.preventDefault();\n\n        Keypairs.assertion(this.state.keypairId, this.state.assertion).then((response) => {\n            var data = parseResponse(response)\n            if (!data.success) {\n                this.setState({error: formatError(data)});\n            } else {\n                window.location = '/accounts';\n            }\n        });\n    }\n\n    render() {\n\n        if (!isUserAdmin(this.props.token)) {\n            return (\n                <div className=\"row\">\n                <AlertBox message={T('error-no-permissions')} />\n                </div>\n            )\n        }\n\n        return (\n            <div>\n\n                <section className=\"row no-border\">\n                    <h2>{T('new-account-key-assertion')}</h2>\n                    <div className=\"col-12\">\n                        <AlertBox message={this.state.error} />\n\n                        <form>\n                            <fieldset>\n                                <label htmlFor=\"keypair\">{T('private-key')}:\n                                    <select value={this.state.keypairId} id=\"keypair\" onChange={this.handleChangeKeypair}>\n                                        <option></option>\n                                        {this.state.keypairs.map((kpr) => {\n                                            if (kpr.Active) {\n                                                return <option key={kpr.ID} value={kpr.ID}>{kpr.AuthorityID}/{kpr.KeyID}</option>;\n                                            } else {\n                                                return <option key={kpr.ID} value={kpr.ID}>{kpr.AuthorityID}/{kpr.KeyID} ({T('inactive')})</option>;\n                                            }\n                                        })}\n                                    </select>\n                                </label>\n                                <label htmlFor=\"key\">{T('assertion')}:\n                                    <input type=\"file\" onChange={this.handleFileUpload} />\n                                </label>\n                            </fieldset>\n                        </form>\n                        <div>\n                            <a href='/accounts' className=\"p-button--neutral\">{T('cancel')}</a>\n                            &nbsp;\n                            <a href='/accounts' onClick={this.handleSaveClick} className=\"p-button--brand\">{T('save')}</a>\n                        </div>\n                    </div>\n                </section>\n                <br />\n            </div>\n        );\n    }\n\n}\n\nexport default AccountKeyForm","/*\n * Copyright (C) 2016-2017 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport React, {Component} from 'react';\nimport Keypairs from '../models/keypairs';\nimport {T} from './Utils'\n\n\nclass KeypairList extends Component {\n\n  handleToggle = (e) => {\n    if (e.target.getAttribute('aria-checked')==='false') {\n      Keypairs.enable(e.target.getAttribute('data-key')).then(this.props.refresh);\n    } else {\n      Keypairs.disable(e.target.getAttribute('data-key')).then(this.props.refresh);\n    }\n\n  }\n\n  renderRow(keypr) {\n    return (\n      <tr key={keypr.ID}>\n        <td className=\"small\">\n          <a href={'/signing-keys/'+keypr.ID} className=\"p-button--brand small\" title={T('edit-keypair')}>\n                <i className=\"fa fa-edit\"></i>\n          </a>\n        </td>\n        <td className=\"overflow\" title={keypr.AuthorityID}>{keypr.AuthorityID}</td>\n        <td className=\"overflow\" title={keypr.KeyID}>{keypr.KeyID}</td>\n        <td>\n          <button data-key={keypr.ID} id=\"key-toggle\" className=\"p-switch\" type=\"button\" role=\"switch\" aria-checked={keypr.Active} \n            aria-labelledby=\"key-toggle\" onClick={this.handleToggle}>\n              <span data-key={keypr.ID} aria-checked={keypr.Active}>On</span>\n              <span data-key={keypr.ID} aria-checked={keypr.Active}>Off</span>\n          </button>\n        </td>\n        <td className=\"overflow\" title={keypr.KeyName}>{keypr.KeyName}</td>\n      </tr>\n    );\n  }\n\n  render() {\n\n    if (this.props.keypairs.length > 0) {\n      return (\n        <table>\n          <thead>\n            <tr>\n              <th className=\"small\" /><th>{T('authority-id')}</th><th>{T('key-id')}</th><th className=\"small\" >{T('active')}</th>\n              <th>{T('key-name')}</th>\n            </tr>\n          </thead>\n          <tbody>\n            {this.props.keypairs.map((keypr) => {\n              return this.renderRow(keypr);\n            })}\n          </tbody>\n        </table>\n      );\n    } else {\n      return (\n        <p>{T('no-signing-keys-found')}</p>\n      );\n    }\n  }\n\n}\n\nexport default KeypairList;\n","/*\n * Copyright (C) 2016-2017 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport React, {Component} from 'react';\nimport Keypairs from '../models/keypairs';\nimport {T} from './Utils'\nimport { setTimeout } from 'timers';\n\n\nclass KeypairStatus extends Component {\n\n  constructor(props) {\n    super(props)\n    this.state = {\n        keypairs: [],\n    }\n\n    this.getKeypairs()\n  }\n\n  poll = () => {\n      // Polls every 30s\n      setTimeout(this.getKeypairs.bind(this), 30000);\n  }\n\n  getKeypairs() {\n    Keypairs.status().then((response) => {\n        var data = JSON.parse(response.body);\n        var message = \"\";\n        if (!data.success) {\n            message = data.message;\n        }\n        this.setState({keypairs: data.status, message: message});\n    })\n    .done( ()=> {\n        this.poll()\n    })\n  }\n\n  renderRow(keypr) {\n    return (\n      <tr key={keypr.id}>\n        <td className=\"overflow\" title={keypr['authority-id']}>{keypr['authority-id']}</td>\n        <td className=\"overflow\" title={keypr['key-name']}>{keypr['key-name']}</td>\n        <td className=\"overflow\" title={keypr.status}>{T(keypr.status)}</td>\n      </tr>\n    );\n  }\n\n  render() {\n\n    if (this.state.keypairs.length > 0) {\n      return (\n          <div className=\"p-card--highlighted spacer\">\n            <table>\n            <tbody>\n                {this.state.keypairs.map((keypr) => {\n                return this.renderRow(keypr);\n                })}\n            </tbody>\n            </table>\n          </div>\n      );\n    } else {\n        return <span />;\n    }\n  }\n\n}\n\nexport default KeypairStatus;\n","// -*- Mode: Go; indent-tabs-mode: t -*-\n\n/*\n * Copyright (C) 2017-2018 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport React, {Component} from 'react';\nimport KeypairList from './KeypairList';\nimport KeypairStatus from './KeypairStatus';\nimport AlertBox from './AlertBox';\nimport {T, isUserAdmin} from './Utils'\n\nclass Keypair extends Component {\n\n  constructor(props) {\n\n    super(props)\n    this.state = {\n      confirmDelete: null,\n      message: null,\n    }\n  }\n\n  componentDidMount() {\n    this.refresh();\n  }\n\n  refresh() {\n    this.props.onRefresh(this.props.selectedAccount)\n  }\n\n  handleRefresh = () => {\n    this.refresh()\n  }\n\n  formatError(data) {\n    var message = T(data.error_code);\n    if (data.error_subcode) {\n      message += ': ' + T(data.error_subcode);\n    } else if (data.message) {\n      message += ': ' + data.message;\n    }\n    return message;\n  }\n\n  render() {\n    if (!isUserAdmin(this.props.token)) {\n      return (\n        <div className=\"row\">\n          <AlertBox message={T('error-no-permissions')} />\n        </div>\n      )\n    }\n\n    return (\n        <div className=\"row\">\n\n          <section className=\"row\">\n            <div className=\"u-equal-height spacer\">\n              <h2 className=\"col-3\">{T('signing-keys')}</h2>\n              &nbsp;\n              <div className=\"col-1\">\n                <a href=\"/signing-keys/new\" className=\"p-button--brand\" title={T('add-new-signing-key')}>\n                  <i className=\"fa fa-plus\"></i>\n                </a>\n              </div>\n              <div className=\"col-1\">\n                <a href=\"/signing-keys/generate\" className=\"p-button--brand\" title={T('generate-signing-key')}>\n                  <i className=\"fa fa-cog\"></i>\n                </a>\n              </div>\n              <div className=\"col-1\">\n                <a href=\"/signing-keys/store\" className=\"p-button--brand\" title={T('register-signing-key')}>\n                  <i className=\"fa fa-shopping-cart\"></i>\n                </a>\n              </div>\n            </div>\n            <div className=\"col-12\">\n              <KeypairStatus token={this.props.token} />\n            </div>\n            <div className=\"col-12\">\n              <KeypairList keypairs={this.props.keypairs} refresh={this.handleRefresh} />\n            </div>\n          </section>\n\n        </div>\n    );\n  }\n}\n\nexport default Keypair;\n","/*\n * Copyright (C) 2016-2017 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport React, {Component} from 'react';\nimport moment from 'moment';\n\n\nclass SigningLogRow extends Component {\n\trender() {\n\t\treturn (\n\t\t\t<tr>\n\t\t\t\t<td className=\"wrap\">{this.props.log.make}</td>\n\t\t\t\t<td className=\"wrap\">{this.props.log.model}</td>\n\t\t\t\t<td className=\"wrap\">{this.props.log.serialnumber}</td>\n\t\t\t\t<td>{this.props.log.revision}</td>\n\t\t\t\t<td className=\"overflow\" title={this.props.log.fingerprint}>{this.props.log.fingerprint}</td>\n\t\t\t\t<td className=\"wrap\">{moment(this.props.log.created).format(\"YYYY-MM-DD HH:mm\")}</td>\n\t\t\t</tr>\n\t\t)\n\t}\n}\n\nexport default SigningLogRow;\n","/*\n * Copyright (C) 2016-2017 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Ajax from './Ajax';\n\nvar SigningLog = {\n    url: 'signinglog',\n\n\tlist: function (fromID) {\n\t\tvar data = {};\n\t\tif (fromID) {\n\t\t\tdata.fromID = fromID;\n\t\t}\n\t\treturn Ajax.get(this.url, data);\n\t},\n\n\tlistForAccount: function (authorityID, offset, filter, serialnumber) {\n\t\treturn Ajax.get(this.url + '/account/' + authorityID , {\n\t\t\toffset: offset,\n\t\t\tfilter: filter,\n\t\t\tserialnumber: serialnumber\n\t\t});\n\t},\n\n\tfilters: function(authorityID) {\n\t\treturn Ajax.get(this.url + '/account/' + authorityID + '/filters');\n\t},\n\n\tdownload: function(authorityID, filter, serialnumber) {\n\t\tAjax.get(this.url + '/account/' + authorityID , {\n\t\t\tall: true,\n\t\t\tfilter: filter,\n\t\t\tserialnumber: serialnumber\n\t\t}).then((response) => {\n\t\t\tvar data = JSON.parse(response.body);\n\t\t\t// Convert the filtered data to a CSV array format\n\t\t\tvar lines = ['data:text/csv;charset=utf-8,ID,Make,Model,Serial Number,Revision,Fingerprint,Date'];\n\n\t\t\tdata.logs.forEach(function(d, index){\n\t\t\t\tvar line = [d.id,d.make,d.model,d.serialnumber,d.revision,d.fingerprint,d.created].join(\",\");\n\t\t\t\tlines.push(line);\n\t\t\t});\n\n\t\t\t// Convert the lines array to a downloadable URI\n\t\t\tvar csvContent = lines.join(\"\\n\");\n\t\t\tvar encodedUri = encodeURI(csvContent);\n\n\t\t\t// Create a temporary link so we can name the download file\n\t\t\tvar downloadLink = document.createElement(\"a\");\n\t\t\tdownloadLink.href = encodedUri;\n\t\t\tdownloadLink.download = \"SigningLogs.csv\";\n\n\t\t\t// Click the link and remove it\n\t\t\tdocument.body.appendChild(downloadLink);\n\t\t\tdownloadLink.click();\n\t\t\tdocument.body.removeChild(downloadLink);\n\t\t});\n\t}\n}\n\nexport default SigningLog;\n","/*\n * Copyright (C) 2017-2018 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport React, { Component } from 'react'\n\n\nclass SigningLogFilter extends Component {\n\n    render() {\n        if (!this.props.expanded) {\n            return (\n                <div className=\"filter-section\">\n                <h5 className='collapsed' onClick={this.props.expansionClick.bind(this, this.props.keyName)}>{this.props.name}</h5>\n                </div>\n            );\n        }\n\n        return (\n            <div className=\"filter-section\">\n            <h5 onClick={this.props.expansionClick.bind(this, this.props.keyName)} className=\"expanded\">{this.props.name}</h5>\n            <ul>\n                {this.props.items.map(function(item, i) {\n                    return (\n                        <li key={i} onClick={this.props.handleItemClick.bind(this, i, this.props.keyName)}>\n                            <span className={item.selected ? \"checked overflow\" : \"unchecked overflow\"}>{item.name}</span>\n                        </li>\n                    );\n                }, this)}\n            </ul>\n            </div>\n        );\n    }\n}\n\nexport default SigningLogFilter","/*\n * Copyright (C) 2016-2018 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport React, { Component } from 'react'\nimport {T} from './Utils'\n\nclass Pagination extends Component {\n\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      page: 1,\n      query: null,\n      maxRecords: 50,\n    }\n  }\n\n  pageUp = () => {\n    var pages = this.calculatePages();\n    var page = this.state.page + 1;\n    if (page > pages) {\n        page = pages;\n    }\n    this.setState({page: page});\n    this.signalPageChange(page);\n  }\n\n  pageDown = () => {\n    var page = this.state.page - 1;\n    if (page <= 0) {\n        page = 1;\n    }\n    this.setState({page: page});\n    this.signalPageChange(page);\n  }\n\n  signalPageChange(page) {\n    // Signal the rows that the owner should display\n    var startRow = ((page - 1) * this.state.maxRecords);\n    this.props.pageChange(startRow, this.props.filterString, this.props.query);\n  }\n\n  calculatePages() {\n    // Use the filtered row count when we a query has been entered\n    var length = this.props.totalLogs\n    var pages = parseInt(length / this.state.maxRecords, 10);\n    if (length % this.state.maxRecords > 0) {\n        pages += 1;\n    }\n\n    if ((this.state.page > pages) && (pages > 0)) {\n        this.setState({page: pages})\n    }\n    return pages;\n  }\n\n  renderPaging() {\n    var pages = this.calculatePages();\n    if (pages > 1) {\n        return (\n            <div className=\"u-float--right\">\n                <button className=\"p-button--neutral\" href=\"\" onClick={this.pageDown}>&laquo;</button>\n                <span>&nbsp;{this.state.page} of {pages}&nbsp;</span>\n                <button className=\"p-button--neutral\" href=\"\" onClick={this.pageUp}>&raquo;</button>\n            </div>\n        );\n    } else {\n        return <div className=\"col-3\"></div>;\n    }\n  }\n\n  render() {\n    return (\n        <div className=\"col-12\">\n            <div className=\"row\">\n                <div className=\"col-9\">\n                    <input type=\"search\" placeholder={this.props.searchText} onChange={this.props.onSearchChange}\n                                value={this.props.query} />\n                </div>\n                {this.renderPaging()}\n            </div>\n            <div className=\"row spacer\">\n                <div className=\"col-6\">\n                    <button className=\"p-button--brand\" onClick={this.props.onDownload}>{T('download')}</button>\n                </div>\n            </div>\n        </div>\n    );\n  }\n}\n\nexport default Pagination\n","/*\n * Copyright (C) 2016-2018 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport React, {Component} from 'react';\nimport SigningLogRow from './SigningLogRow';\nimport AlertBox from './AlertBox';\nimport SigningLogModel from '../models/signinglog' \nimport SigningLogFilter from './SigningLogFilter'\nimport Pagination from './Pagination'\nimport {T, isUserAdmin} from './Utils'\n\nconst PAGINATION_SIZE = 50;\n\nclass SigningLog extends Component {\n  constructor(props) {\n\n    super(props)\n    this.state = {\n        logs: [],\n        filterModels: [],\n        filterString: '',\n        message: null,\n        expanded: {models: true},\n        query: '',\n        startRow: 0,\n        endRow: PAGINATION_SIZE,\n        totalLogs: 0,\n        authorityID: this.props.selectedAccount.AuthorityID,\n    };\n    this.getSigningLogs(0, '', '')\n    this.getSigningLogFilters(this.state.authorityID)\n  }\n\n  handleExpansionClick = (value) => {\n    var expanded = this.state.expanded;\n    expanded[value] = !expanded[value]\n    this.setState({expanded: expanded})\n  }\n\n  handleItemClick = (index, key) => {\n    var items;\n    if (key === 'models') {\n      items = this.state.filterModels;\n      items[index].selected = !items[index].selected;\n      var filter = items.filter(i => i.selected === true).map(i => i.name).join(',')\n      this.getSigningLogs(0, filter, this.state.query)\n      this.setState({filterModels: items, filterString: filter});\n    }\n  }\n\n  getSigningLogs = (offset, filter, serialnumber) => {\n    SigningLogModel.listForAccount(this.state.authorityID, offset, filter, serialnumber).then((response) => {\n      var data = JSON.parse(response.body);\n      var message = null;\n      if (!data.success) {\n        message = data.message;\n      }\n      this.setState({logs: data.logs, message: message, totalLogs: data.total_count});\n    });\n  }\n\n  getSigningLogFilters = () => {\n    SigningLogModel.filters(this.state.authorityID).then((response) => {\n      var data = JSON.parse(response.body);\n      var message = \"\";\n      if (!data.success) {\n        message = data.message;\n      }\n      var filterModels = data.filters.models.map(function(item) {\n        return {name: item, selected: false};\n      });\n      this.setState({filterModels: filterModels, message: message});\n    });\n  }\n\n  handleSearchChange = (e) => {\n    this.getSigningLogs(0, this.state.filterString, e.target.value)\n    this.setState({query: e.target.value});\n  }\n\n  handleDownload = () => {\n    SigningLogModel.download(this.state.authorityID, this.state.filterString, this.state.query);\n  }\n\n  selectedFilters(name) {\n    var items = [];\n    name.map(function(n) {\n      if(n.selected) {\n        items.push(n.name);\n      }\n      return n.name\n    });\n    return items;\n  }\n\n  renderTable(items) {\n    if (this.state.logs.length > 0) {\n      return (\n        <div>\n          <table>\n            <thead>\n              <tr>\n                <th>{T('brand')}</th><th>{T('model')}</th><th>{T('serial-number')}</th><th>{T('revision')}</th><th>{T('fingerprint')}</th><th>{T('date')}</th>\n              </tr>\n            </thead>\n            <tbody>\n              {this.renderRows(items)}\n            </tbody>\n          </table>\n        </div>\n      );\n    } else {\n      return (\n        <p>No models signed.</p>\n      );\n    }\n  }\n\n  renderRows(items) {\n    return items.map((l) => {\n      return (\n        <SigningLogRow key={l.id} log={l} />\n      );\n    });\n  }\n\n  render() {\n    if (!isUserAdmin(this.props.token)) {\n      return (\n        <div className=\"row\">\n          <AlertBox message={T('error-no-permissions')} />\n        </div>\n      )\n    }\n\n    return (\n        <div className=\"row\">\n\n          <section className=\"row\">\n            <h2>{T('signinglog')}</h2>\n            <div className=\"col-12\">\n              <p>{T('signinglog-description')}</p>\n            </div>\n            <div className=\"col-12\">\n              <AlertBox message={this.state.message} />\n            </div>\n\n            <div className=\"row\">\n              <div className=\"col-3\">\n                <div className=\"p-card filter\">\n                  <div className=\"filter-section\">\n                      <h4>Filter By</h4>\n                      <SigningLogFilter\n                          name={T('models')} items={this.state.filterModels}\n                          keyName={'models'}\n                          handleItemClick={this.handleItemClick}\n                          expanded={this.state.expanded.models}\n                          expansionClick={this.handleExpansionClick}\n                      />\n                  </div>\n                </div>\n              </div>\n              <div className=\"col-9\">\n                <Pagination totalLogs={this.state.totalLogs}\n                            query={this.state.query}\n                            searchText={T('find-serialnumber')}\n                            pageChange={this.getSigningLogs}\n                            filterString={this.state.filterString}\n                            onDownload={this.handleDownload}\n                            onSearchChange={this.handleSearchChange} />\n\n                {this.renderTable(this.state.logs)}\n\n              </div>\n            </div>\n\n          </section>\n\n        </div>\n    );\n\n  }\n\n}\n\nexport default SigningLog;","/*\n * Copyright (C) 2018-2019 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport React, {Component} from 'react'\nimport {T, isUserAdmin} from './Utils';\n\n\nclass SubstoreForm extends Component {\n\n    handleChangeSerial = (e) => {\n        e.preventDefault()\n        this.props.onChange('serialnumber', e.target.value)\n    }\n\n    handleChangeSubstore = (e) => {\n        e.preventDefault()\n        this.props.onChange('store', e.target.value)\n    }\n\n    handleChangeFromModel = (e) => {\n        e.preventDefault()\n        this.props.onChange('fromModelID', parseInt(e.target.value, 10))\n    }\n\n    handleChangeModelName = (e) => {\n        e.preventDefault()\n        this.props.onChange('modelname', e.target.value)\n    }\n\n    render() {\n\n        var b = this.props.substore\n\n        return (\n            <tr>\n                <td colSpan=\"5\">\n                    <form>\n                        <fieldset>\n                            <label htmlFor=\"fromModel\">{T('model')}:\n                                <select value={b.fromModelID} id=\"fromModel\" onChange={this.handleChangeFromModel}>\n                                    <option></option>\n                                    {this.props.models.map(function(m) {\n                                        return <option key={m.id} value={m.id}>{m.model}</option>;\n                                    })}\n                                </select>\n                            </label>\n\n                            <label htmlFor=\"serial\">{T('serial-number')}:\n                                <input type=\"text\" id=\"serial\" placeholder={T('serial-number-description')}\n                                    value={b.serialnumber} onChange={this.handleChangeSerial} />\n                            </label>\n\n                            <label htmlFor=\"substore\">{T('substore')}:\n                                <input type=\"text\" id=\"substore\" placeholder={T('substore-description')}\n                                    value={b.store} onChange={this.handleChangeSubstore} />\n                            </label>\n\n                            <label htmlFor=\"modelname\">{T('modelname')}:\n                                <input type=\"text\" id=\"modelname\" placeholder={T('modelname-description')}\n                                    value={b.modelname} onChange={this.handleChangeModelName} />\n                            </label>\n                        </fieldset>\n                        {isUserAdmin(this.props.token) ?\n                          <span>\n                            <button className=\"p-button--neutral\" onClick={this.props.onCancel} data-key={b.id}>{T('cancel')}</button>\n                            <button className=\"p-button--brand\" onClick={this.props.onSave} data-key={b.id}>{T('save')}</button>\n                          </span>\n                          : <button className=\"p-button--neutral\" onClick={this.props.onCancel} data-key={b.id}>{T('close')}</button>\n                        }\n                    </form>\n                </td>\n            </tr>\n        )\n    }\n}\n\nexport default SubstoreForm\n","/*\n * Copyright (C) 2018 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport React, {Component} from 'react'\nimport  AlertBox from './AlertBox'\nimport Accounts from '../models/accounts'\nimport {T, isUserAdmin, formatError} from './Utils';\nimport SubstoreForm from './SubstoreForm';\nimport DialogBox from './DialogBox';\n\n\nclass SubstoreList extends Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            error: null,\n            showNew: false,\n            showEdit: null,\n            showDelete: null,\n            substore: {},\n        }\n    }\n\n    handleShowNew = (e) => {\n        e.preventDefault();\n        this.setState({showNew: true, showEdit: null, showDelete: null, substore: {}})\n    }\n\n    handleShowEdit = (e) => {\n        e.preventDefault();\n        var id = parseInt(e.target.getAttribute('data-key'), 10);\n        if (this.state.showEdit === id) {\n            this.setState({showEdit: null, substore: {}, showDelete: null, showNew: false})\n        } else {\n            var substores = this.props.substores.filter( (s) => {\n                return s.id === id\n            })\n\n            this.setState({substore: substores[0], showEdit: id, showDelete: null, showNew: false})\n        }\n    }\n\n    handleShowDelete = (e) => {\n        e.preventDefault();\n        var id = parseInt(e.target.getAttribute('data-key'), 10);\n        if (this.state.showDelete === id) {\n            this.setState({showDelete: null, showEdit: null, showNew: false})\n        } else {\n            var substores = this.props.substores.filter( (s) => {\n                return s.id === id\n            })\n            this.setState({substore: substores[0], showDelete: id, showEdit: null, showNew: false})\n        }\n    }\n\n    handleSubstoreChange = (field, value) => {\n        var s = this.state.substore\n        s[field] = value\n        this.setState({substore: s})\n    }\n\n    handleSaveSubstore = (e) => {\n        e.preventDefault()\n\n        if (!isUserAdmin(this.props.token)) {\n            window.location = '/accounts';\n        }\n\n        if (!this.state.substore.id) {\n            Accounts.storeNew(this.props.selectedAccount.ID, this.state.substore).then((response) => {\n                var data = JSON.parse(response.body);\n                if (response.statusCode >= 300) {\n                    this.setState({error: formatError(data)});\n                } else {\n                    this.setState({substore: {}, showNew: false, showEdit: null, showDelete: null, error: null})\n                    this.props.onRefresh(this.props.selectedAccount)\n                }\n            })\n        } else {\n            Accounts.storeUpdate(this.state.substore).then((response) => {\n                var data = JSON.parse(response.body);\n                if (response.statusCode >= 300) {\n                    this.setState({error: formatError(data)});\n                } else {\n                    this.props.onRefresh(this.props.selectedAccount)\n                    this.setState({substore: {}, showNew: false, showEdit: null, showDelete: null, error: null})\n                }\n            })\n        }\n    }\n\n    handleDeleteSubstore = (e) => {\n        e.preventDefault()\n\n        Accounts.storeDelete(this.state.substore).then((response) => {\n            var data = JSON.parse(response.body);\n            if (response.statusCode >= 300) {\n                this.setState({error: formatError(data)});\n            } else {\n                this.props.onRefresh(this.props.selectedAccount)\n                this.setState({substore: {}, showNew: false, showEdit: null, showDelete: null, error: null})\n            }\n        })\n    }\n\n    handleCancelSubstore = (e) => {\n        e.preventDefault()\n        this.setState({substore: {}, showNew: false, showEdit: null, showDelete: null, error: null})\n        this.props.onRefresh(this.props.selectedAccount)\n    }\n\n    renderActions(b) {\n        if (this.state.showDelete === b.id) {\n            return (\n                <DialogBox message={T('confirm-store-delete')} handleYesClick={this.handleDeleteSubstore} handleCancelClick={this.handleCancelSubstore} small />\n            );\n        } else {\n            return (\n                <div>\n                    <a href=\"\" data-key={b.id} onClick={this.handleShowEdit} className=\"p-button--brand small\" title={T('edit-model')}>\n                        <i data-key={b.id} className=\"fa fa-pencil\" />\n                    </a>\n                    &nbsp;\n                    <a href=\"\" data-key={b.id} onClick={this.handleShowDelete} className=\"p-button--neutral small\" title={T('delete-model')}>\n                        <i data-key={b.id} className=\"fa fa-trash\" />\n                    </a>\n                </div>\n            )\n        }\n    }\n\n    renderSubstore(b) {\n        return (\n            <tr>\n                <td>\n                    {this.renderActions(b)}\n                </td>\n                <td className=\"overflow\" title={b.fromModel.model}>{b.fromModel.model}</td>\n                <td className=\"overflow\" title={b.serialnumber}>{b.serialnumber}</td>\n                <td className=\"overflow\" title={b.store}>{b.store}</td>\n                <td className=\"overflow\" title={b.modelname}>{b.modelname}</td>\n            </tr>\n        )\n    }\n\n    render() {\n        if (!isUserAdmin(this.props.token)) {\n            return (\n                <div className=\"row\">\n                <AlertBox message={T('error-no-permissions')} />\n                </div>\n            )\n        }\n\n        return (\n            <div>\n                <section className=\"row no-border\">\n                    <div>\n                        <div className=\"u-equal-height\">\n                            <h2 className=\"p-card__title col-5\">{T('substores')}</h2>\n                            &nbsp;\n                            <div className=\"col-1\">\n                                <a href=\"\" onClick={this.handleShowNew} className=\"p-button--brand\" title={T('new-substore-device')}>\n                                    <i className=\"fa fa-plus\"></i>\n                                </a>\n                            </div>\n                        </div>\n\n                        <AlertBox message={this.state.error} />\n\n                        <table>\n                          <thead>\n                            <tr>\n                                <th></th><th>{T('model')}</th><th>{T('serial-number')}</th>\n                                <th>{T('substore')}</th><th>{T('substore-model')}</th>\n                            </tr>\n                          </thead>\n                          <tbody>\n                              {this.state.showNew ?\n                                    <SubstoreForm substore={this.state.substore} models={this.props.models} token={this.props.token}\n                                        onSave={this.handleSaveSubstore} onChange={this.handleSubstoreChange} onCancel={this.handleCancelSubstore} />\n                                : ''\n                              }\n                              {this.props.substores.map((b) => {\n                                if (b.id === this.state.showEdit) {\n                                    return (<SubstoreForm substore={this.state.substore} models={this.props.models} token={this.props.token}\n                                                onSave={this.handleSaveSubstore} onChange={this.handleSubstoreChange} onCancel={this.handleCancelSubstore} />)\n                                } else {\n                                    return this.renderSubstore(b)\n                                }\n                              })}\n                          </tbody>\n                        </table>\n                    </div>\n                </section>\n            </div>\n        )\n\n    }\n\n}\n\nexport default SubstoreList\n","/*\n * Copyright (C) 2016-2017 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Ajax from './Ajax';\n\nvar Assertion = {\n\turl: 'assertions',\n\n\tcreate:  function(assert) {\n\t\treturn Ajax.post(this.url, assert);\n\t}\n}\n\nexport default Assertion;","/*\n * Copyright (C) 2017-2018 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport React, {Component} from 'react'\nimport moment from 'moment'\nimport AlertBox from './AlertBox'\nimport Assertion from '../models/assertions'\nimport {T, isUserStandard} from './Utils'\n\nimport DatePicker from 'react-datepicker'\nimport 'react-datepicker/dist/react-datepicker-cssmodules.css'\n\nclass SystemUserForm extends Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            email: '',\n            username: '',\n            password: '',\n            name: '',\n            model: 0,\n            since: moment.utc(),\n            until: moment.utc().add(1, 'year'),\n            message: '',\n            assertion: null,\n        }\n    }\n\n    submitAssertion(form) {\n        Assertion.create(form).then((response) => {\n            var data = JSON.parse(response.body);\n            var message = null;\n            if (!data.success) {\n                message = data.message;\n            }\n\n            if (data.success) {\n                this.setState({assertion: data.assertion, message: message})\n            } else {\n                this.setState({message: message})\n            }\n        })\n    }\n\n    downloadAssertion () {\n        return 'data:application/octet-stream;charset=utf-8,' + encodeURIComponent(this.state.assertion)\n    }\n\n    onShowForm= (e) => {\n        e.preventDefault()\n        this.setState({assertion: null})\n    }\n\n    handleChangeEmail = (e) => {\n        this.setState({email: e.target.value});\n    }\n\n    handleChangeUsername = (e) => {\n        this.setState({username: e.target.value});\n    }\n\n    handleChangePassword = (e) => {\n        this.setState({password: e.target.value});\n    }\n\n    handleChangeName = (e) => {\n        this.setState({name: e.target.value});\n    }\n\n    handleChangeModel = (e) => {\n        this.setState({model: parseInt(e.target.value, 10)});\n    }\n\n    handleChangeSinceDate = (date) => {\n        // Get the time from the current setting\n        date.hours(this.state.since.hours())\n        date.minutes(this.state.since.minutes())\n        date.seconds(this.state.since.seconds())\n\n        this.setState({since: date});\n    }\n\n    handleChangeSinceTime = (e) => {\n        var time = e.target.value.split(':')\n        var t = this.state.since\n        t.hours(time[0])\n        t.minutes(time[1])\n        t.seconds(0)\n\n        this.setState({since: t});\n    }\n\n    handleChangeUntilDate = (date) => {\n        // Get the time from the current setting\n        date.hours(this.state.until.hours())\n        date.minutes(this.state.until.minutes())\n        date.seconds(this.state.until.seconds())\n\n        this.setState({until: date});\n    }\n\n    handleChangeUntilTime = (e) => {\n        var time = e.target.value.split(':')\n        var t = this.state.until\n        t.hours(time[0])\n        t.minutes(time[1])\n        t.seconds(0)\n\n        this.setState({until: t});\n    }\n\n    onSubmit = (e) => {\n        e.preventDefault()\n\n        var form = {\n            email: this.state.email,\n            username: this.state.username,\n            password: this.state.password,\n            name:     this.state.name,\n            model:    this.state.model,\n            since:    this.state.since.format('YYYY-MM-DDTHH:mm:ss') + 'Z',\n            until:    this.state.until.format('YYYY-MM-DDTHH:mm:ss') + 'Z',\n        }\n        if (this.validate(form)) {\n            // this.props.onSubmit(form)\n            this.submitAssertion(form)\n        }\n    }\n\n    validate(form) {\n        // Check the mandatory fields\n        if ((!form.email) || (!form.username) || (!form.password) || (!form.name) || (!form.model) || (form.model === 0)) {\n            this.setState({message: 'All the fields must be entered'});\n            return false;\n        }\n\n        // Check the email\n        if (! /^[a-zA-Z0-9.!#$%&*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$/.test(form.email)) {\n            this.setState({message: 'The email is not valid'});\n            return false\n        }\n\n        this.setState({message: ''})\n        return true;\n    }\n\n    render() {\n\n        if (!isUserStandard(this.props.token)) {\n            return (\n                <div className=\"row\">\n                <AlertBox message={T('error-no-permissions')} />\n                </div>\n            )\n        }\n\n        if (this.state.assertion) {\n            return (\n                <div className=\"row\">\n                    <a href=\"#form\" onClick={this.onShowForm}>&laquo; Back to the form</a>\n                    <h3>System User Assertion</h3>\n\n                    <pre>{this.state.assertion}</pre>\n                    <a className=\"p-button--brand\" href={this.downloadAssertion()} download=\"auto-import.assert\">Download</a>\n                </div>\n            )\n        }\n\n        return (\n            <div className=\"row\">\n\n                <h2>{T('create-system-user')}</h2>\n\n                <AlertBox message={this.state.message} type={'negative'} />\n\n                <form>\n                    <fieldset>\n                        <label htmlFor=\"email\">Email:\n                            <input type=\"email\" name=\"email\" required placeholder=\"email address\" onChange={this.handleChangeEmail} value={this.state.email} />\n                        </label>\n                        <label htmlFor=\"username\">Username:\n                            <input type=\"text\" name=\"username\" placeholder=\"system-user name\" onChange={this.handleChangeUsername} value={this.state.username} />\n                        </label>\n                        <label htmlFor=\"password\">Password:\n                            <input type=\"password\" name=\"password\" placeholder=\"password for the system-user\" onChange={this.handleChangePassword} value={this.state.password} />\n                        </label>\n                        <label htmlFor=\"name\">Full Name:\n                            <input type=\"text\" name=\"name\" placeholder=\"name of the user\" onChange={this.handleChangeName} value={this.state.name} />\n                        </label>\n                        <label htmlFor=\"name\">Model:\n                            <select onChange={this.handleChangeModel} value={this.state.model.id}>\n                                <option value={0}>--</option>\n                            {this.props.models.map((m) => {\n                                return (\n                                    <option key={m.id} value={m.id}>{m['brand-id']} {m.model}</option>\n                                )\n                            })}\n                            </select>\n                        </label>\n                        <label htmlFor=\"since\">Since (UTC):\n                            <div className=\"row\">\n                                <div className=\"col-3\">\n                                    <DatePicker selected={this.state.since} onChange={this.handleChangeSinceDate} />\n                                </div>\n                                <div className=\"col-3\">\n                                    <input type=\"time\" name=\"since_time\" title=\"the time the assertion is valid from (UTC)\" onChange={this.handleChangeSinceTime} value={this.state.since.format('HH:mm')} />\n                                </div>\n                            </div>\n                        </label>\n                        <label htmlFor=\"until\">Until (UTC):\n                            <div className=\"row\">\n                                <div className=\"col-3\">\n                                    <DatePicker selected={this.state.until} onChange={this.handleChangeUntilDate} />\n                                </div>\n                                <div className=\"col-3\">\n                                    <input type=\"time\" name=\"until_time\" title=\"the time the assertion is valid until (UTC)\" onChange={this.handleChangeUntilTime} value={this.state.until.format('HH:mm')} />\n                                </div>\n                            </div>\n                        </label>\n                    \n                    </fieldset>\n                    <button className=\"p-button--brand\" onClick={this.onSubmit}>Create</button>\n                </form>\n            </div>\n        )\n    }\n}\n\nexport default SystemUserForm\n","/*\n * Copyright (C) 2018 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport React, {Component} from 'react';\nimport {T} from './Utils'\n\nclass NavigationSubmenu extends Component {\n\n    render() {\n        var index = 0;\n        return (\n            <nav className=\"p-tabs\">\n            <ul className=\"p-tabs__list\" role=\"tablist\">\n                {\n                    this.props.items.map((item) => {\n                        index += 1\n                        return (\n                            <li className=\"p-tabs__item\" role=\"presentation\">\n                                <a href={'/' + item} className=\"p-tabs__link\" tabIndex={index} role=\"tab\"\n                                    aria-controls={item} aria-selected={item===this.props.selected}>\n                                    {T(item)}\n                                </a>\n                            </li>\n                        )\n                    })\n                }\n            </ul>\n            </nav>\n        )\n    }\n}\n\nexport default NavigationSubmenu;\n","/*\n * Copyright (C) 2017 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport React, {Component} from 'react';\nimport DialogBox from './DialogBox';\nimport {T, roleAsString} from './Utils'\n\nclass UserRow extends Component {\n\trenderActions() {\n\t\tif (this.props.user.ID !== this.props.confirmDelete) {\n\t\t\treturn (\n\t\t\t\t<div>\n\t\t\t\t\t<a href={'/users/'.concat(this.props.user.ID, '/edit')} className=\"p-button--brand\" title={T('edit-user')}><i className=\"fa fa-pencil\"></i></a>\n\t\t\t\t\t&nbsp;\n\t\t\t\t\t<a href=\"\" onClick={this.props.delete} data-key={this.props.user.ID} className=\"p-button--neutral\" title={T('delete-user')}>\n\t\t\t\t\t\t<i className=\"fa fa-trash\" data-key={this.props.user.ID}></i></a>\n\t\t\t\t</div>\n\t\t\t);\n\t\t} else {\n\t\t\treturn (\n\t\t\t\t<DialogBox message={T('confirm-user-delete')} handleYesClick={this.props.deleteUser} handleCancelClick={this.props.cancelDelete} />\n\t\t\t);\n\t\t}\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<tr>\n\t\t\t\t<td>\n\t\t\t\t\t{this.renderActions()}\n\t\t\t\t</td>\n\t\t\t\t<td className=\"overflow\" title={this.props.user.Username}>{this.props.user.Username}</td>\n\t\t\t\t<td className=\"overflow\" title={this.props.user.Name}>{this.props.user.Name}</td>\n\t\t\t\t<td className=\"overflow\" title={this.props.user.Email}>{this.props.user.Email}</td>\n\t\t\t\t<td className=\"overflow\" title={roleAsString(this.props.user.Role)}>{roleAsString(this.props.user.Role)}</td>\n\t\t\t\t<td className=\"overflow\" title={this.props.user.APIKey}>{this.props.user.APIKey}</td>\n\t\t\t</tr>\n\t\t)\n\t}\n}\n\nexport default UserRow;\n","/*\n * Copyright (C) 2017 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport Ajax from './Ajax';\n\nvar Users = {\n\turl: 'users',\n\n\tlist: function () {\n\t\treturn Ajax.get(this.url);\n\t},\n\n\tget: function(userId) {\n\t\treturn Ajax.get(this.url + '/' + userId);\n\t},\n\n\tgetotheraccounts: function(userId) {\n\t\treturn Ajax.get(this.url + '/' + userId + '/otheraccounts');\n\t},\n\n\tupdate:  function(user) {\n\t\treturn Ajax.put(this.url + '/' + user.id, user);\n\t},\n\n\tdelete:  function(user) {\n\t\treturn Ajax.delete(this.url + '/' + user.ID, {});\n\t},\n\n\tcreate:  function(user) {\n\t\treturn Ajax.post(this.url, user);\n\t}\n\n}\n\nexport default Users;\n","// -*- Mode: Go; indent-tabs-mode: t -*-\n\n/*\n * Copyright (C) 2017 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport React, {Component} from 'react';\nimport UserRow from './UserRow';\nimport AlertBox from './AlertBox';\nimport Users from '../models/users';\nimport {T, isUserSuperuser} from './Utils'\n\nclass UserList extends Component {\n\n  constructor(props) {\n    super(props)\n    this.state = {\n      users: this.props.users || [],\n      confirmDelete: null,\n      message: null,\n    }\n  }\n\n  componentDidMount() {\n    this.refresh();\n  }\n\n  refresh() {\n    this.getUsers();\n  }\n\n  handleRefresh = () => {\n    this.refresh()\n  }\n\n  getUsers() {\n    Users.list().then((response) => {\n      var data = JSON.parse(response.body);\n      var message = \"\";\n      if (!data.success) {\n        message = data.message;\n      }\n      this.setState({users: data.users, message: message});\n    });\n  }\n\n  formatError(data) {\n    var message = T(data.error_code);\n    if (data.error_subcode) {\n      message += ': ' + T(data.error_subcode);\n    } else if (data.message) {\n      message += ': ' + data.message;\n    }\n    return message;\n  }\n\n  handleDelete = (e) => {\n    e.preventDefault();\n    this.setState({confirmDelete: parseInt(e.target.getAttribute('data-key'), 10)});\n  }\n\n  handleDeleteUser = (e) => {\n    e.preventDefault();\n    var users = this.state.users.filter((user) => {\n      return user.ID === this.state.confirmDelete;\n    });\n    if (users.length === 0) {\n      return;\n    }\n\n    Users.delete(users[0]).then((response) => {\n      var data = JSON.parse(response.body);\n      if ((response.statusCode >= 300) || (!data.success)) {\n        this.setState({message: this.formatError(data)});\n      } else {\n        window.location = '/users';\n      }\n    });\n  }\n\n  handleDeleteUserCancel = (e) => {\n    e.preventDefault();\n    this.setState({confirmDelete: null});\n  }\n\n  renderTable() {\n\n    if (this.state.users.length > 0) {\n      return (\n        <table>\n          <thead>\n            <tr>\n              <th></th><th>{T('username')}</th><th>{T('name')}</th><th>{T('email')}</th><th>{T('role')}</th><th>{T('api-key')}</th>\n            </tr>\n          </thead>\n          <tbody>\n            {this.state.users.map((user) => {\n              return (\n                <UserRow key={user.ID} user={user} delete={this.handleDelete} confirmDelete={this.state.confirmDelete}\n                  deleteUser={this.handleDeleteUser} cancelDelete={this.handleDeleteUserCancel} />\n              );\n            })}\n          </tbody>\n        </table>\n      );\n    } else {\n      return (\n        <p>No users found.</p>\n      );\n    }\n  }\n\n  render() {\n    if (!isUserSuperuser(this.props.token)) {\n      return (\n        <div className=\"row\">\n          <AlertBox message={T('error-no-permissions')} />\n        </div>\n      )\n    }\n\n    return (\n        <div className=\"row\">\n\n          <section className=\"row\">\n            <div className=\"u-equal-height\">\n              <h2 className=\"col-3\">{T('users')}</h2>\n              &nbsp;\n              <div className=\"col-1\"><a href=\"/users/new\" className=\"p-button--brand\" title={T('add-new-user')}>\n                <i className=\"fa fa-plus\"></i>\n              </a></div>\n            </div>\n            <div className=\"col-12\">\n              <p>{T('users_available')}:</p>\n            </div>\n            <div className=\"col-12\">\n              <AlertBox message={this.state.message} />\n            </div>\n            <div className=\"col-12\">\n              {this.renderTable()}\n            </div>\n          </section>\n\n        </div>\n    );\n  }\n}\n\nexport default UserList;\n","/*\n * Copyright (C) 2016-2017 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport React, {Component} from 'react';\nimport AlertBox from './AlertBox';\nimport Users from '../models/users';\nimport Accounts from '../models/accounts';\nimport {T, isUserSuperuser} from './Utils';\n\nclass UserEdit extends Component {\n\n    constructor(props) {\n        super(props)\n        this.state = {\n            title: null,\n            user: {},\n            error: null,\n            hideForm: false,\n            // TODO temporary move user.Accounts to userAccounts, as backend provides accounts for the user \n            // that way. In future this will be get in an independant call.\n            assignedAccounts: [],\n            availableAccounts: [],\n        }\n    }\n\n    componentDidMount() {\n        if (this.props.id) {\n            this.setTitle('edit-user');\n            this.getUser(this.props.id);\n        } else {\n            this.setTitle('new-user');\n        }\n        this.getAllAccounts();\n    }\n\n    setTitle(title) {\n        this.setState({title: T(title)});\n    }\n\n    getUser(userId) {\n        Users.get(userId).then((response) => {\n            var data = JSON.parse(response.body);\n\n            if (response.statusCode >= 300) {\n                this.setState({error: this.formatError(data), hideForm: true});\n            } else {\n                this.setState({\n                    user: data.user, \n                    assignedAccounts: this.accountsToAuthorityIDs(data.user.Accounts),\n                    hideForm: false,\n                });\n            }\n        });\n    }\n\n    getAllAccounts() {\n        var self = this;\n        Accounts.list().then(function(response) {\n            var data = JSON.parse(response.body);\n            self.setState({\n                availableAccounts: self.accountsToAuthorityIDs(data.accounts),\n            });\n        });\n    }\n\n    accountsToAuthorityIDs(accounts) {\n        var accs = [];\n        for (var i = 0; i < accounts.length; ++i) {\n            accs.push(accounts[i].AuthorityID)\n        }\n        return accs;\n    }\n\n    formatError(data) {\n        var message = T(data.error_code);\n        if (data.error_subcode) {\n            message += ': ' + T(data.error_subcode);\n        } else if (data.message) {\n            message += ': ' + data.message;\n        }\n        return message;\n    }\n\n    buildSelectBoxOption = (val) => {\n        return <option key={val} value={val}>{val}</option>; \n    }\n\n    handleChangeUsername = (e) => {\n        var user = this.state.user;\n        user.Username = e.target.value;\n        this.setState({user: user});\n    }\n\n    handleChangeName = (e) => {\n        var user = this.state.user;\n        user.Name = e.target.value;\n        this.setState({user: user});\n    }\n\n    handleChangeEmail = (e) => {\n        var user = this.state.user;\n        user.Email = e.target.value;\n        this.setState({user: user});\n    }\n\n    handleChangeRole = (e) => {\n        var user = this.state.user;\n        user.Role = parseInt(e.target.value, 10);\n        this.setState({user: user});\n    }\n\n    buildRequestData() {\n        var requestData = {}\n        var user = this.state.user\n        requestData['id'] = user.ID\n        requestData['username'] = user.Username\n        requestData['name'] = user.Name\n        requestData['email'] = user.Email\n        requestData['role'] = user.Role\n        requestData['api_key'] = user.APIKey\n        requestData['accounts'] = this.state.assignedAccounts\n        return requestData\n    }\n\n    handleSaveClick = (e) => {\n        e.preventDefault();\n\n        var requestData = this.buildRequestData()\n\n        if (requestData.id) {\n            // Update the existing user\n            Users.update(requestData).then((response) => {\n                var data = JSON.parse(response.body);\n                if (response.statusCode >= 300) {\n                    this.setState({error: this.formatError(data)});\n                } else {\n                    window.location = '/users';\n                }\n            });\n        } else {\n            // Create a new user\n            Users.create(requestData).then((response) => {\n                var data = JSON.parse(response.body);\n                if (response.statusCode >= 300) {\n                    this.setState({error: this.formatError(data)});\n                } else {\n                    window.location = '/users';\n                }\n            });\n        }\n    }\n\n    handleClickAccount = (e) => {\n        e.preventDefault();\n        var acc = e.target.getAttribute('data-account');\n        var accounts = this.state.assignedAccounts;\n\n        var index = this.state.assignedAccounts.indexOf(acc);\n        if (index < 0) {\n            // Not found, so select it\n            accounts.push(acc);\n        } else {\n            // Found, so remove it\n            accounts.splice(index, 1);\n        }\n        this.setState({assignedAccounts: accounts});\n    }\n\n    renderAccountSelect(acc) {\n        var style = 'p-button--neutral';\n        if (this.state.assignedAccounts.indexOf(acc) >= 0) {\n            style = 'p-button--brand';\n        }\n\n        return (\n            <button key={acc} data-account={acc} onClick={this.handleClickAccount} className={style}>\n                {acc}\n            </button>\n        );\n    }\n\n    renderError() {\n        if (this.state.error) {\n            return (\n                <AlertBox message={this.state.error} />\n            );\n        }\n    }\n\n    render() {\n        var self = this;\n\n        if (!isUserSuperuser(this.props.token)) {\n            return (\n                <div className=\"row\">\n                <AlertBox message={T('error-no-permissions')} />\n                </div>\n            )\n        }\n\n        if (this.state.hideForm) {\n            return (\n                <div className=\"row\">\n                <AlertBox message={this.state.error} />\n                </div>\n            )\n        }\n\n        return (\n            <div className=\"row\">\n                <section className=\"row\">\n                      <h2>{this.state.title}</h2>\n\n                        <AlertBox message={this.state.error} />\n\n                        <form>\n                            <fieldset>\n                                <label htmlFor=\"username\">{T('username')}:\n                                    <input type=\"text\" id=\"username\" placeholder={T('user-username')}\n                                        value={this.state.user.Username} onChange={this.handleChangeUsername} />\n                                </label>\n                                <label htmlFor=\"name\">{T('name')}:\n                                    <input type=\"text\" id=\"name\" placeholder={T('user-name')}\n                                        value={this.state.user.Name} onChange={this.handleChangeName}/>\n                                </label>\n                                <label htmlFor=\"email\">{T('email')}:\n                                    <input type=\"text\" id=\"email\" placeholder={T('user-email')}\n                                        value={this.state.user.Email} onChange={this.handleChangeEmail}/>\n                                </label>\n                                <label htmlFor=\"role\">{T('role')}:\n                                    <select value={this.state.user.Role} id=\"role\" onChange={this.handleChangeRole}>\n                                        <option></option>\n                                        <option key=\"standard\" value=\"100\">Standard</option>\n                                        <option key=\"syncuser\" value=\"150\">Sync API</option>\n                                        <option key=\"admin\" value=\"200\">Admin</option>\n                                        <option key=\"superuser\" value=\"300\">Superuser</option>\n                                    </select>\n                                </label>\n                                <label htmlFor=\"api-key\">{T('api-key')}:\n                                    <input type=\"text\" id=\"api-key\" placeholder={T('api-key')} \n                                        value={this.state.user.APIKey} readOnly />\n                                </label>\n                            </fieldset>\n\n                            <h3>{T('user-accounts')}</h3>\n                            \n                            <fieldset>\n                                <p>{T('select-accounts')}</p>\n\n                                <div>\n                                    {this.state.availableAccounts.map(function(acc) {\n                                        return self.renderAccountSelect(acc);\n                                    })}\n                                </div>\n                            </fieldset>\n                        </form>\n\n                        <div>\n                            <a href='/users' className=\"p-button--neutral\">{T('cancel')}</a>\n                            &nbsp;\n                            <a href='/users' onClick={this.handleSaveClick} className=\"p-button--brand\">{T('save')}</a>\n                        </div>\n                </section>\n                <br />\n            </div>\n        )\n    }\n}\n\nexport default UserEdit;\n","/*\n * Copyright (C) 2017-2018 Canonical Ltd\n * License granted by Canonical Limited\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport React, { Component } from 'react';\nimport Header from './components/Header'\nimport Footer from './components/Footer'\nimport Index from './components/Index'\nimport ModelList from './components/ModelList'\nimport ModelEdit from './components/ModelEdit'\nimport KeypairAdd from './components/KeypairAdd'\nimport KeypairEdit from './components/KeypairEdit'\nimport KeypairGenerate from './components/KeypairGenerate'\nimport KeypairStore from './components/KeypairStore'\nimport AccountList from './components/AccountList'\nimport AccountForm from './components/AccountForm'\nimport AccountEdit from './components/AccountEdit'\nimport AccountKeyForm from './components/AccountKeyForm'\nimport Keypair from './components/Keypair'\nimport SigningLog from './components/SigningLog'\nimport SubstoreList from './components/SubstoreList'\nimport SystemUserForm from './components/SystemUserForm'\nimport NavigationSubmenu from './components/NavigationSubmenu';\nimport UserList from './components/UserList'\nimport UserEdit from './components/UserEdit'\nimport Accounts from './models/accounts'\nimport Keypairs from './models/keypairs'\nimport Models from './models/models';\nimport {sectionFromPath, sectionIdFromPath, subSectionIdFromPath, isLoggedIn, getAccount, saveAccount, isUserAdmin, isUserSuperuser, formatError} from './components/Utils'\nimport createHistory from 'history/createBrowserHistory'\nimport './sass/App.css'\n\nconst history = createHistory()\nconst submenuModels = ['models','substores','systemuser']\n\nclass App extends Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      location: history.location,\n      token: props.token || {},\n      models: [],\n      accounts: [],\n      keypairs: [],\n      substores: [],\n      selectedAccount: getAccount() || {},\n    }\n\n    history.listen(this.handleNavigation.bind(this))\n    this.getAccounts()\n  }\n\n  handleNavigation(location) {\n    this.setState({ location: location })\n    window.scrollTo(0, 0)\n  }\n\n  getAccounts() {\n    if (isLoggedIn(this.props.token)) {\n      Accounts.list().then((response) => {\n          var data = JSON.parse(response.body);\n          var message = \"\";\n          if (!data.success) {\n              message = data.message;\n          }\n\n          var selectedAccount = this.state.selectedAccount;\n          if ((!this.state.selectedAccount.ID) && (!getAccount().AuthorityID)) {\n            // Set to the first in the account list\n            if (data.accounts.length > 0) {\n              selectedAccount = data.accounts[0]\n              saveAccount(selectedAccount)\n            }\n          } else {\n            // Refresh the current account details\n            if (data.accounts.length > 0) {\n              var accs = data.accounts.filter((a) => {\n                return this.state.selectedAccount.ID === a.ID\n              })\n              if (accs.length > 0) {\n                selectedAccount = accs[0]\n                saveAccount(selectedAccount)\n              }\n            }\n          }\n\n          this.updateDataForRoute(selectedAccount)\n          this.setState({accounts: data.accounts, selectedAccount: selectedAccount, message: message});\n      });\n    }\n  }\n\n  getKeypairs(authorityID) {\n    Keypairs.list().then((response) => {\n        var data = JSON.parse(response.body);\n        var message = \"\";\n        if (!data.success) {\n            message = data.message;\n        }\n\n        var keypairs = data.keypairs.filter((k) => {\n            return k.AuthorityID === authorityID;\n        })\n\n        this.setState({keypairs: keypairs, message: message});\n    });\n  }\n\n  getModels(authorityID) {\n    Models.list().then((response) => {\n      var data = JSON.parse(response.body);\n      var message = \"\";\n      if (!data.success) {\n        message = data.message;\n      }\n\n      var models = data.models.filter((m) => {\n        return m['brand-id'] === authorityID;\n      })\n\n      this.setState({models: models, message: message});\n    });\n  }\n\n  getSubstores(accountId) {\n    Accounts.stores(accountId).then((response) => {\n        var data = JSON.parse(response.body);\n\n        if (response.statusCode >= 300) {\n            this.setState({message: formatError(data), hideForm: true});\n        } else {\n            this.setState({substores: data.substores, message: null});\n        }\n    });\n  }\n\n  updateDataForRoute(selectedAccount) {\n    var currentSection = sectionFromPath(window.location.pathname);\n\n    if(currentSection==='accounts') {this.getKeypairs(selectedAccount.AuthorityID)}\n    if(currentSection==='signing-keys') {this.getKeypairs(selectedAccount.AuthorityID)}\n    if(currentSection==='models') {\n      this.getModels(selectedAccount.AuthorityID)\n      this.getKeypairs(selectedAccount.AuthorityID)\n    }\n    if(currentSection==='substores') {\n      if (selectedAccount.ID) {\n        this.getSubstores(selectedAccount.ID)\n      }\n      this.getModels(selectedAccount.AuthorityID)\n    }\n    if(currentSection==='systemuser') {this.getModels(selectedAccount.AuthorityID)}\n  }\n\n  handleAccountChange = (account) => {\n    saveAccount(account)\n    this.setState({selectedAccount: account})\n\n    this.updateDataForRoute(account)\n  }\n\n  renderModels() {\n    const id = sectionIdFromPath(window.location.pathname, 'models')\n  \n    switch(id) {\n      case 'new':\n        return <ModelEdit token={this.props.token} id={null} selectedAccount={this.state.selectedAccount} keypairs={this.state.keypairs} />\n      case '':\n        return <ModelList token={this.props.token} selectedAccount={this.state.selectedAccount} models={this.state.models} />\n      default:\n        return <ModelEdit token={this.props.token} id={id} selectedAccount={this.state.selectedAccount} keypairs={this.state.keypairs} />\n    }\n  }\n\n  renderAccounts() {\n    const id = sectionIdFromPath(window.location.pathname, 'accounts')\n    const sub = subSectionIdFromPath(window.location.pathname, 'accounts')\n\n    switch(id) {\n      case 'upload':\n        return <AccountForm token={this.props.token} />\n      case 'new':\n        return <AccountEdit token={this.props.token} />\n      case 'account':\n        return <AccountEdit id={sub} token={this.props.token} />\n      case 'key-assertion':\n        return <AccountKeyForm token={this.props.token} />\n      default:\n        return <AccountList token={this.props.token} selectedAccount={this.state.selectedAccount} keypairs={this.state.keypairs} />\n    }\n  }\n\n  renderUsers() {\n    const id = sectionIdFromPath(window.location.pathname, 'users')\n\n    switch(id) {\n      case 'new':\n        return <UserEdit token={this.props.token} />\n      case '':\n        return <UserList token={this.props.token} />\n      default:\n        return <UserEdit token={this.props.token} id={id} />\n    }\n  }\n\n  renderKeypairs() {\n    const id = sectionIdFromPath(window.location.pathname, 'signing-keys')\n\n    switch(id) {\n      case 'generate':\n        return <KeypairGenerate token={this.props.token} selectedAccount={this.state.selectedAccount} />\n      case 'new':\n        return <KeypairAdd token={this.props.token} selectedAccount={this.state.selectedAccount} />\n      case '':\n        return <Keypair token={this.props.token} selectedAccount={this.state.selectedAccount} keypairs={this.state.keypairs} onRefresh={this.handleAccountChange} />\n      case 'store':\n        return <KeypairStore token={this.props.token} selectedAccount={this.state.selectedAccount} keypairs={this.state.keypairs} />\n      default:\n        return <KeypairEdit token={this.props.token} id={id} />\n    }\n  }\n\n  render() {\n    var currentSection = sectionFromPath(window.location.pathname);\n\n    return (\n      <div className=\"App\">\n          <Header token={this.props.token}\n            accounts={this.state.accounts} selectedAccount={this.state.selectedAccount} \n            onAccountChange={this.handleAccountChange} />\n\n          <div className=\"spacer\" />\n\n          {(isUserAdmin(this.props.token)||isUserSuperuser(this.props.token)) &&\n           (currentSection==='models'||currentSection==='substores'||currentSection==='systemuser')? \n            <section className=\"row\">\n              <NavigationSubmenu items={submenuModels} selected={currentSection} />\n            </section>\n          : ''}\n  \n          {currentSection==='home'? <Index token={this.props.token} /> : ''}\n          {currentSection==='notfound'? <Index token={this.props.token} error /> : ''}\n\n          {currentSection==='signing-keys'? this.renderKeypairs(): ''}\n          {currentSection==='models'? this.renderModels() : ''}\n\n          {currentSection==='accounts'? this.renderAccounts() : ''}\n          {currentSection==='signinglog'? <SigningLog \n              token={this.props.token} \n              selectedAccount={this.state.selectedAccount} /> : ''}\n\n          {currentSection==='substores'? <SubstoreList token={this.props.token}\n            selectedAccount={this.state.selectedAccount} onRefresh={this.handleAccountChange}\n            substores={this.state.substores} models={this.state.models} /> : ''}\n          {currentSection==='systemuser'? <SystemUserForm token={this.props.token} models={this.state.models} /> : ''}\n\n          {currentSection==='users'? this.renderUsers() : ''}\n\n          <Footer />\n      </div>\n    )\n  }\n}\n\nexport default App;\n","/*\n * Copyright (C) 2016-2017 Canonical Ltd\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License version 3 as\n * published by the Free Software Foundation.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see <http://www.gnu.org/licenses/>.\n *\n */\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n//import registerServiceWorker from './registerServiceWorker';\nimport {getAuthToken}      from './components/Utils'\n\n// Imports for i18n\nimport {IntlProvider} from 'react-intl';\n\n// Translated messages\nimport Messages from './components/messages';\n\nwindow.AppState = {\n  container: document.getElementById(\"main\"),\n\n  getLocale: function() {\n    return localStorage.getItem('locale') || 'en';\n  },\n\n  setLocale: function(lang) {\n    localStorage.setItem('locale', lang);\n  },\n\n  render: function() {\n    var locale = this.getLocale();\n\n    getAuthToken( (token) => {\n      ReactDOM.render((\n        <IntlProvider locale={locale} messages={Messages[locale]}>\n          <App token={token} />\n        </IntlProvider>\n      ), this.container);\n    })\n  },\n\n  unmount: function() {\n    ReactDOM.unmountComponentAtNode(this.container);\n  },\n\n  rerender: function() {\n    this.unmount();\n    this.render();\n  }\n}\n\nwindow.AppState.render()\n//registerServiceWorker();\n"],"sourceRoot":""}